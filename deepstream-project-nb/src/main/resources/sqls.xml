<?xml version="1.0" encoding="UTF-8"?>
<sqls>
    <sql name="MZCFXX"><![CDATA[
CREATE TABLE MZCFXX (
`KFDM` STRING,
`LX` STRING,
`NO` BIGINT,
`SFNO` BIGINT,
`SFNO1` STRING,
`FYRY` STRING,
`FYRYZH` STRING,
`PYRY` STRING,
`KSBH` STRING,
`YSBH` STRING,
`YSZH` STRING,
`GHKSBH` STRING,
`DYNO` STRING,
`CKBH` STRING,
`PYZT` STRING,
`YPJJ` STRING,
`PYSJ` STRING,
`FYSJ` STRING,
`CFMS` STRING,
`MBBH` STRING,
`PDAPYZT` STRING,
`HJCS` STRING,
`ZXCFH` STRING,
`YXH` STRING,
proctime as PROCTIME(),
PRIMARY KEY (`KFDM`,`LX`,`NO`) NOT ENFORCED
)
 WITH (
'connector' = 'kafka',
'topic' = '9',
'properties.bootstrap.servers' = 'localhost:9092',
'properties.group.id' = 'k_default',
'scan.startup.mode' = 'earliest-offset',
'format' = 'ruisoft-koalaspeed')
]]></sql>
    <sql name="KTDOC_PRESCRIPTION_LIST"><![CDATA[
CREATE TABLE KTDOC_PRESCRIPTION_LIST (
`PRES_ID` INTEGER,
`NO` INTEGER,
`DISPENSARY_ID` STRING,
`TIMES` INTEGER,
`GROUPNO` INTEGER,
`DRUG_ID` INTEGER,
`EMP_ID` INTEGER,
`DOSAGE` INTEGER,
`DOSE` INTEGER,
`USAGE` STRING,
`DRUG_WAY` STRING,
`REMARK` STRING,
`QUANTITY` INTEGER,
`SKIN_TEST` CHAR,
`SELF_MARK` CHAR,
`MED_INS_MARK` CHAR,
`DETAIL_DOSE_FLAG` CHAR,
`WARN_TAG` INTEGER,
`SPE_MEDICINE` STRING,
`HIS5_CP_NO` INTEGER,
`HIS5_NODE_ID` INTEGER,
`YJ_SQDBH` INTEGER,
`HZ_SQDBH` INTEGER,
`LIMIT_REASON` STRING,
`ALLQUANTITY` INTEGER,
`ZJ` INTEGER,
`IS_MAIN` STRING
)
 WITH (
'connector' = 'jdbc',
'url' = 'jdbc:oracle:thin:@10.48.100.105:1521:orcl',
'table-name' = 'KTHIS.KTDOC_PRESCRIPTION_LIST',
'username' = 'cdc',
'password' = 'oracle',
'driver' = 'oracle.jdbc.driver.OracleDriver')
]]></sql>
    <sql name="KTDOC_PRESCRIPTION"><![CDATA[
CREATE TABLE KTDOC_PRESCRIPTION (
`PRES_ID` INTEGER,
`CLINIC_ID` INTEGER,
`CHARGE_ID` INTEGER,
`RECORD_TIME` DATE,
`TYPE` CHAR,
`EMP_ID` INTEGER,
`CATEGORY` INTEGER,
`DECOCTION_DAY` INTEGER,
`FEE_PRES_ID` INTEGER,
`SERIAL_NUMBER` INTEGER,
`DEMAND` STRING,
`OUT_NO` INTEGER,
`APPLY_NO` INTEGER,
`SOURCE_NO` STRING,
`CENTER_PRESID` STRING,
`COMPOUND_FLAG` STRING,
`SPEC_FLAG` STRING,
`OUT_PRESID` STRING,
`RESCUE` STRING,
`YLLBDM` STRING,
`BZDM` STRING,
`INVALID_TIME` DATE,
PRIMARY KEY (`PRES_ID`) NOT ENFORCED
)
 WITH (
'connector' = 'jdbc',
'url' = 'jdbc:oracle:thin:@10.48.100.105:1521:orcl',
'table-name' = 'KTHIS.KTDOC_PRESCRIPTION',
'username' = 'cdc',
'password' = 'oracle',
'driver' = 'oracle.jdbc.driver.OracleDriver')
]]></sql>
    <sql name="YPMC"><![CDATA[
CREATE TABLE YPMC (
`YPBH` INTEGER,
`DM` STRING,
`HZMC` STRING,
`GG` STRING,
`DW` STRING,
`CD` INTEGER,
`CDMC` STRING,
`PFJ` INTEGER,
`LSJ` INTEGER,
`YPJL` INTEGER,
`JLDW` STRING,
`LX` INTEGER,
`JX` INTEGER,
`YL` STRING,
`FL` INTEGER,
`PSBJ` STRING,
`DW1` STRING,
`SL1` INTEGER,
`DW2` STRING,
`SL2` INTEGER,
`ZFBZ` STRING,
`GFXL` INTEGER,
`YBFL` STRING,
`TYM` STRING,
`YBYPBM` STRING,
`YBTS` STRING,
`YPGLBZ` STRING,
`GZYP` STRING,
`YBBL1` INTEGER,
`YBBL2` INTEGER,
`YBBL3` INTEGER,
`YBBL4` INTEGER,
`KWM` STRING,
`NEXTNO1` INTEGER,
`YPSY` STRING,
`MZSY` STRING,
`ZYSY` STRING,
`LSJLX` INTEGER,
`GJLSJ` INTEGER,
`MZYBXL` INTEGER,
`KSSJB` STRING,
`YBSYBZ` STRING,
`QZFS` STRING,
`TSYPDJ` STRING,
`SYPZZX` STRING,
`ZDYSX` INTEGER,
`CAT_HIS5_ORDER_ID` INTEGER,
`HIS5_ORDER_ID` INTEGER,
`TYM2` STRING,
PRIMARY KEY (`YPBH`) NOT ENFORCED
)
 WITH (
'connector' = 'jdbc',
'url' = 'jdbc:oracle:thin:@10.48.100.105:1521:orcl',
'table-name' = 'HMISW2003.YPMC',
'username' = 'cdc',
'password' = 'oracle',
'driver' = 'oracle.jdbc.driver.OracleDriver')
]]></sql>
    <sql name="KTDOC_WORK_LOG"><![CDATA[
CREATE TABLE KTDOC_WORK_LOG (
`CLINIC_ID` INTEGER,
`REGISTER_ID` INTEGER,
`EMP_ID` INTEGER,
`DEPT_ID` INTEGER,
`START_TIME` DATE,
`END_TIME` DATE,
`SICK_ID` INTEGER,
`TYPE` STRING,
`DIAGNOSE` STRING,
`ICD10` STRING,
`OPERTATION` STRING,
`SICKEN_TIME` DATE,
`RESULT` CHAR,
`GREEN_CHANNEL` CHAR,
`SPILE` CHAR,
`RISK` CHAR,
`ZYMOSIS` CHAR,
`CHRONIC` CHAR,
`FLU` CHAR,
`TRANS` CHAR,
`REMARKS` STRING,
`BRANCH_CODE` STRING,
`STATE` CHAR,
`PARENTS_NAME` STRING,
`COMPANY` STRING,
`HOUSE_TYPE` INTEGER,
`SICK_DURATION` INTEGER,
`DURATION_UNIT` STRING,
`ADDRESS` STRING,
`TELE` STRING,
`CURE_LEVEL` STRING,
`SYSPTOM_CODE` STRING,
`SURGERY_TIME` DATE,
`ZZBZ` STRING,
`ZZNR` STRING,
`DZBL` STRING,
`ZZSJ` DATE,
PRIMARY KEY (`CLINIC_ID`) NOT ENFORCED
)
 WITH (
'connector' = 'jdbc',
'url' = 'jdbc:oracle:thin:@10.48.100.105:1521:orcl',
'table-name' = 'KTHIS.KTDOC_WORK_LOG',
'username' = 'cdc',
'password' = 'oracle',
'driver' = 'oracle.jdbc.driver.OracleDriver')
]]></sql>
    <sql name="YPMCQT"><![CDATA[
CREATE TABLE YPMCQT (
`YPBH` INTEGER,
`JHJJ` INTEGER,
`JKYPZJDYXRQ` DATE,
`ZCSB` STRING,
`PZWH` STRING,
`GMPBH` STRING,
`GMPRZSJ` DATE,
`GMPDQSJ` DATE,
`YLCPZCZBH` STRING,
`YLCPZCZYXRQ` DATE,
`JKYPZCZBH` STRING,
`JKYPZCZYXRQ` DATE,
`JKYPJYBGSBH` STRING,
`JKYPJYBGSYXRQ` DATE,
`JKYPZJDBH` STRING,
`ORIS` STRING,
`CCHJSD` STRING,
`CCHJZGBZ` STRING,
`CCHJWD` INTEGER,
`MAXL` INTEGER,
`CKJYL` INTEGER,
`YXQ` INTEGER,
`CFYPFL` STRING,
`MINL` INTEGER,
`JHDW` STRING,
`TJBZ` STRING,
`JBYW` STRING,
`FSSJ` DATE,
`PSXSF` STRING,
`WXYP` STRING,
`WHYP` STRING,
`SJLX` STRING,
`TSTS` STRING,
`JSBZ` STRING,
`KBDJB` STRING,
`MRFF` STRING,
`KPY` STRING,
`ZYJ` STRING,
`PZWHYXRQ` DATE,
`SCGRYPJYBGBH` STRING,
`SCGRYPJYBGPH` STRING,
`YPSCXKZBH` STRING,
`YPSCXKZPZRQ` DATE,
`YPSCXKZYXRQ` DATE,
`JKYPJYBGSPH` STRING,
`SWZPPQFHGZBH` STRING,
`SWZPPQFHGZPH` STRING,
`SWZPPQFHGZYXRQ` DATE,
`FRWTSYXRQ` DATE,
`DABH` STRING,
`DDD` INTEGER,
`ZZYP` CHAR,
`WPYP` STRING,
`YPZCZBH` STRING,
`YPZCZYXRQ` DATE,
`PSCS` INTEGER,
`RSWXXJB` STRING,
`TMCF` STRING,
`SYYYBZ` STRING,
`YMZLDM` STRING,
`JZCS` INTEGER,
`PSYP` INTEGER,
`RJX` STRING,
`TSPSYP` STRING,
`JCYY` STRING,
`JZTY` STRING,
`JZTYTSXX` STRING,
`YHXYP` STRING,
`DZBZ` STRING,
`DS` STRING,
`SQMBZ` STRING,
`PSSC` INTEGER,
`DSXX` INTEGER,
`DSSX` INTEGER,
`DYBZ` STRING,
`PHGL` STRING,
`ZLYP` STRING,
`JHBZBZ` STRING,
`SYTSTS` STRING,
`YLJLXSFS` STRING,
`JMBZ` STRING,
`KYJS` INTEGER,
`SYYXQZ` INTEGER,
`SFSQ` STRING,
`NL` INTEGER,
`SYTPXS` INTEGER,
`JPCCWD` STRING,
`JPCCSJ` INTEGER,
`ZBDM` STRING,
`MRYHFS` INTEGER,
`GJYPID` STRING,
`KZLYP` STRING,
`YBGJYPBM` STRING,
`ZYLSSY` STRING,
`SPTYPID` STRING,
`BRQYYWXDJ` STRING,
`ECPS` STRING,
`GTYP` INTEGER,
PRIMARY KEY (`YPBH`) NOT ENFORCED
)
 WITH (
'connector' = 'jdbc',
'url' = 'jdbc:oracle:thin:@10.48.100.105:1521:orcl',
'table-name' = 'HMISW2003.YPMCQT',
'username' = 'cdc',
'password' = 'oracle',
'driver' = 'oracle.jdbc.driver.OracleDriver')
]]></sql>
    <sql name="KSMC"><![CDATA[
CREATE TABLE KSMC (
`NO` STRING,
`MC` STRING,
PRIMARY KEY (`NO`) NOT ENFORCED
)
 WITH (
'connector' = 'jdbc',
'url' = 'jdbc:oracle:thin:@10.48.100.105:1521:orcl',
'table-name' = 'HMISW2003.KSMC',
'username' = 'cdc',
'password' = 'oracle',
'driver' = 'oracle.jdbc.driver.OracleDriver')
]]></sql>
    <sql name="ZGXX"><![CDATA[
CREATE TABLE ZGXX (
`ID` INTEGER,
`XM` STRING,
`SRM1` STRING,
`SRM2` STRING,
`KSNO` STRING,
`CF` STRING,
`LX` STRING,
`PSWORD` STRING,
`FPNO` INTEGER,
`SRMLX` STRING,
`ZH` INTEGER,
`STAT` STRING,
`ZJF` INTEGER,
`MZF` STRING,
`JSF` STRING,
`DPF` STRING,
`PSF` STRING,
`QTHM` INTEGER,
`ZC` STRING,
`BATJDYBH` STRING,
`SSJB` STRING,
`KSSJB` STRING,
`ZYKSNO` STRING,
`KSSTJQX` STRING,
`ZW` STRING,
`ZNZW` STRING,
`WPF` STRING,
`PWD_XGSJ` DATE,
`KSSYJSHJB` STRING,
`ZXID` STRING,
PRIMARY KEY (`ID`) NOT ENFORCED
)
 WITH (
'connector' = 'jdbc',
'url' = 'jdbc:oracle:thin:@10.48.100.105:1521:orcl',
'table-name' = 'HMISW2003.ZGXX',
'username' = 'cdc',
'password' = 'oracle',
'driver' = 'oracle.jdbc.driver.OracleDriver')
]]></sql>
    <sql name="MZGHXX"><![CDATA[
CREATE TABLE MZGHXX (
`MZH` INTEGER,
`BRXM` STRING,
`JZKH` STRING,
`BRBH` INTEGER,
`MZKB` STRING,
`MZLX` STRING,
`GHF` INTEGER,
`ZLF` INTEGER,
`ZJF` INTEGER,
`BLKF` INTEGER,
`CKF` INTEGER,
`GHRY` INTEGER,
`ZFRY` INTEGER,
`KSBH` STRING,
`YSBH` INTEGER,
`YSZH` INTEGER,
`ZTBZ` STRING,
`FPNO` STRING,
`LB` STRING,
`GFNO` STRING,
`YHLX` STRING,
`YHHM` STRING,
`YBRYDM` STRING,
`GHSJ` DATE,
`KSXH` INTEGER,
`MZSJ` STRING,
`SYBZ` STRING,
`JZYSBH` INTEGER,
`SFFYZT` STRING,
`GHLY` INTEGER,
`ZDH` STRING,
`PBYS` INTEGER,
`YHCX` STRING,
`GHLB` STRING,
`HZLY` STRING,
`FZBZ` STRING,
`HSZT` STRING,
`QMLXDM` STRING,
`QMJDDM` STRING,
`GCPLX` STRING,
`TYJSBRLY` STRING,
`DKDM` STRING,
PRIMARY KEY (`MZH`) NOT ENFORCED
)
 WITH (
'connector' = 'jdbc',
'url' = 'jdbc:oracle:thin:@10.48.100.105:1521:orcl',
'table-name' = 'HMISW2003.MZGHXX',
'username' = 'cdc',
'password' = 'oracle',
'driver' = 'oracle.jdbc.driver.OracleDriver')
]]></sql>
    <sql name="SYSVAR"><![CDATA[
CREATE TABLE SYSVAR (
`PROG` STRING,
`VNAME` STRING,
`VVALUE` STRING,
`TITLE` STRING,
`MEMO` STRING,
`RIGHT` STRING,
`BZ` STRING,
PRIMARY KEY (`PROG`,`VNAME`) NOT ENFORCED
)
 WITH (
'connector' = 'jdbc',
'url' = 'jdbc:oracle:thin:@10.48.100.105:1521:orcl',
'table-name' = 'HMISW2003.SYSVAR',
'username' = 'cdc',
'password' = 'oracle',
'driver' = 'oracle.jdbc.driver.OracleDriver')
]]></sql>
    <sql name="CFFL"><![CDATA[
CREATE TABLE CFFL (
`XH` INTEGER,
`MC` STRING,
`TITLE` STRING,
`BZ` STRING,
`YFGS` STRING,
`JC` STRING,
`CFLSH` INTEGER,
`YSGS` STRING,
`YXTS` INTEGER,
`KFDM` STRING,
`SYBZ` STRING,
`PXXH` INTEGER,
`SWJBM` STRING
)
 WITH (
'connector' = 'jdbc',
'url' = 'jdbc:oracle:thin:@10.48.100.105:1521:orcl',
'table-name' = 'HMISW2003.CFFL',
'username' = 'cdc',
'password' = 'oracle',
'driver' = 'oracle.jdbc.driver.OracleDriver')
]]></sql>
    <sql name="YZYFB"><![CDATA[
CREATE TABLE YZYFB (
`DM` STRING,
`MC` STRING,
`NUM` INTEGER,
`TS` INTEGER,
`XH` INTEGER,
`SYSYBZ` STRING,
`BZ` STRING,
`SYBZ` STRING,
`ZBPC` INTEGER,
`ZSJGSJ` INTEGER,
`HIS5_ORDER_ID` INTEGER,
`YWMC` STRING,
PRIMARY KEY (`DM`) NOT ENFORCED
)
 WITH (
'connector' = 'jdbc',
'url' = 'jdbc:oracle:thin:@10.48.100.105:1521:orcl',
'table-name' = 'HMISW2003.YZYFB',
'username' = 'cdc',
'password' = 'oracle',
'driver' = 'oracle.jdbc.driver.OracleDriver')
]]></sql>
    <sql name="GYFSB"><![CDATA[
CREATE TABLE GYFSB (
`DM` STRING,
`MC` STRING,
`YLFYBH` STRING,
`BZ` STRING,
`SYSYBZ` STRING,
`XH` INTEGER,
`XEYLFYBH` STRING,
`SYBZ` STRING,
`LX` STRING,
`CLYLFYBH` STRING,
`XECLYLFYBH` STRING,
`YLFYBH2` STRING,
`HIS5_ORDER_ID` INTEGER,
`ZYYLFYBH` STRING,
`ZYXEYLFYBH` STRING,
`YWMC` STRING,
PRIMARY KEY (`DM`) NOT ENFORCED
)
 WITH (
'connector' = 'jdbc',
'url' = 'jdbc:oracle:thin:@10.48.100.105:1521:orcl',
'table-name' = 'HMISW2003.GYFSB',
'username' = 'cdc',
'password' = 'oracle',
'driver' = 'oracle.jdbc.driver.OracleDriver')
]]></sql>
    <sql name="YPJX"><![CDATA[
CREATE TABLE YPJX (
`NO` INTEGER,
`MC` STRING,
`XH` STRING,
`LX` STRING,
`JC` STRING,
`SRM1` STRING,
`SRM2` STRING,
`QDYL` STRING,
PRIMARY KEY (`NO`) NOT ENFORCED
)
 WITH (
'connector' = 'jdbc',
'url' = 'jdbc:oracle:thin:@10.48.100.105:1521:orcl',
'table-name' = 'HMISW2003.YPJX',
'username' = 'cdc',
'password' = 'oracle',
'driver' = 'oracle.jdbc.driver.OracleDriver')
]]></sql>
    <sql name="MZCFMXXX"><![CDATA[
CREATE TEMPORARY TABLE MZCFMXXX (
`KFDM` STRING,
`LX` STRING,
`NO` INTEGER,
`NO1` INTEGER,
`ZH` INTEGER,
`DM` INTEGER,
`DM1` INTEGER,
`JL` INTEGER,
`SL` INTEGER,
`DJ` INTEGER,
`GYFS` STRING,
`YF` STRING,
`FF` STRING,
`BYZSCS` INTEGER,
`JS` INTEGER,
`JE` INTEGER,
`XFJE` INTEGER,
`ZBBZ` STRING,
`PSJG` STRING,
`LSJLX` INTEGER,
`GJLSJ` INTEGER,
`YPJJ` INTEGER,
`GZYP` STRING,
`MK_TAG` INTEGER,
`ZFBZ` STRING,
`MCYL` INTEGER,
`ZFJE` INTEGER,
`JMJE` INTEGER,
`YBZFJE` INTEGER,
PRIMARY KEY (`KFDM`,`LX`,`NO`,`NO1`) NOT ENFORCED
)
 WITH (
'connector' = 'jdbc',
'url' = 'jdbc:oracle:thin:@10.48.100.105:1521:orcl',
'table-name' = 'HMISW2003.MZCFMXXX',
'username' = 'cdc',
'password' = 'oracle',
'driver' = 'oracle.jdbc.driver.OracleDriver')
]]></sql>
    <!--    <sql name="MZCFXX"><![CDATA[-->
    <!--CREATE TABLE MZCFXX (-->
    <!--`KFDM` STRING,-->
    <!--`LX` STRING,-->
    <!--`NO` INTEGER,-->
    <!--`SFNO` INTEGER,-->
    <!--`SFNO1` INTEGER,-->
    <!--`FYRY` INTEGER,-->
    <!--`FYRYZH` INTEGER,-->
    <!--`PYRY` INTEGER,-->
    <!--`KSBH` STRING,-->
    <!--`YSBH` INTEGER,-->
    <!--`YSZH` INTEGER,-->
    <!--`GHKSBH` STRING,-->
    <!--`DYNO` INTEGER,-->
    <!--`CKBH` INTEGER,-->
    <!--`PYZT` STRING,-->
    <!--`YPJJ` INTEGER,-->
    <!--`PYSJ` DATE,-->
    <!--`FYSJ` DATE,-->
    <!--`CFMS` STRING,-->
    <!--`MBBH` INTEGER,-->
    <!--`PDAPYZT` STRING,-->
    <!--`HJCS` INTEGER,-->
    <!--`ZXCFH` STRING,-->
    <!--`YXH` STRING,-->
    <!--PRIMARY KEY (`KFDM`,`LX`,`NO`) NOT ENFORCED-->
    <!--)-->
    <!-- WITH (-->
    <!--'connector' = 'jdbc',-->
    <!--'url' = 'jdbc:oracle:thin:@10.48.100.105:1521:orcl',-->
    <!--'table-name' = 'HMISW2003.MZCFXX',-->
    <!--'username' = 'cdc',-->
    <!--'password' = 'oracle',-->
    <!--'driver' = 'oracle.jdbc.driver.OracleDriver',-->
    <!--'lookup.cache.max-rows' = '50000',-->
    <!--'lookup.cache.ttl' = '60min')-->
    <!--]]></sql>-->
    <sql name="MZSFXX"><![CDATA[
CREATE TABLE MZSFXX (
`NO` INTEGER,
`BRXM` STRING,
`FBLX` STRING,
`GFNO` STRING,
`YSBH` INTEGER,
`YSZH` INTEGER,
`KSBH` STRING,
`FPNO` STRING,
`DYNO` INTEGER,
`KPRY` INTEGER,
`KPRYZH` INTEGER,
`MZH` INTEGER,
`CD` STRING,
`GHKSBH` STRING,
`SFLY` STRING,
`FSSJ` DATE,
`GZCS` INTEGER,
`SFZT` STRING,
`YHLX` STRING,
`YHHM` STRING,
`YHCX` STRING,
`ZFZT` STRING,
`ZFNO` INTEGER,
`DKLB` STRING,
PRIMARY KEY (`NO`) NOT ENFORCED
)
 WITH (
'connector' = 'jdbc',
'url' = 'jdbc:oracle:thin:@10.48.100.105:1521:orcl',
'table-name' = 'HMISW2003.MZSFXX',
'username' = 'cdc',
'password' = 'oracle',
'driver' = 'oracle.jdbc.driver.OracleDriver')
]]></sql>
    <sql name="KTDOC_DIAGNOSE"><![CDATA[
CREATE TABLE KTDOC_DIAGNOSE (
`CLINIC_ID` INTEGER,
`NO` INTEGER,
`ICD` STRING,
`DISEASE_NAME` STRING,
`REMARKS` STRING,
`EMP_ID` INTEGER,
`CREATE_ORG_CODE` STRING,
`CREATE_ORG_NAME` STRING,
`CREATE_DATE` DATE,
`TECH_ID` INTEGER,
`DETAIL` STRING,
`DISEASE_TIME` DATE,
`DISEASE_TYPE` STRING,
`DISEASE_OUTCOME` STRING,
`TCM_SYNDROME` INTEGER,
PRIMARY KEY (`CLINIC_ID`,`NO`) NOT ENFORCED
)
 WITH (
'connector' = 'jdbc',
'url' = 'jdbc:oracle:thin:@10.48.100.105:1521:orcl',
'table-name' = 'KTHIS.KTDOC_DIAGNOSE',
'username' = 'cdc',
'password' = 'oracle',
'driver' = 'oracle.jdbc.driver.OracleDriver')
]]></sql>
    <sql name="KTDOC_CASE_HISTORY"><![CDATA[
CREATE TABLE KTDOC_CASE_HISTORY (
`CLINIC_ID` INTEGER,
`EMP_ID` INTEGER,
`DEPT_ID` INTEGER,
`RECORD_TIME` DATE,
`FIELD` STRING,
`REMARKS` STRING,
`SOURCE_NO` STRING,
PRIMARY KEY (`CLINIC_ID`,`FIELD`) NOT ENFORCED
)
 WITH (
'connector' = 'jdbc',
'url' = 'jdbc:oracle:thin:@10.48.100.105:1521:orcl',
'table-name' = 'KTHIS.KTDOC_CASE_HISTORY',
'username' = 'cdc',
'password' = 'oracle',
'driver' = 'oracle.jdbc.driver.OracleDriver')
]]></sql>
    <sql name="S_CLI_RECIPE"><![CDATA[
CREATE TABLE S_CLI_RECIPE (
`BASE_ID` VARCHAR,
`HOSP_ID` VARCHAR,
`HOSP_NAME` VARCHAR,
`BATCH_NO` VARCHAR,
`PATIENT_ID` VARCHAR,
`OUTP_ID` VARCHAR,
`OUTP_NO` VARCHAR,
`RECIPE_NO` VARCHAR,
`RECIPE_DTIME` VARCHAR,
`RECIPE_DEPT_CODE` VARCHAR,
`RECIPE_DEPT_NAME` VARCHAR,
`RECIPE_DOC_CODE` VARCHAR,
`RECIPE_DOC_NAME` VARCHAR,
`DRUG_FLAG` VARCHAR,
`ITEM_CODE` VARCHAR,
`ITEM_NAME` VARCHAR,
`ITEM_TYPE_CODE` VARCHAR,
`ITEM_TYPE_NAME` VARCHAR,
`UNIT_PRICE` VARCHAR,
`QTY` VARCHAR,
`UNIT` VARCHAR,
`SPEC` VARCHAR,
`DRUG_RECP_TYPECODE` VARCHAR,
`DRUG_RECP_TYPENAME` VARCHAR,
`DRUG_USE_FREQCODE` VARCHAR,
`DRUG_USE_FREQNAME` VARCHAR,
`DRUG_EACH_DOSE` VARCHAR,
`DRUG_DOSE_UNIT` VARCHAR,
`DRUG_USAGE_CODE` VARCHAR,
`DRUG_USAGE_NAME` VARCHAR,
`DOSAGE_FORM_CODE` VARCHAR,
`DOSAGE_FORM_NAME` VARCHAR,
`DRUG_TOTAL_DOSE` VARCHAR,
`DRUG_TOTAL_UNIT` VARCHAR,
`DRUG_START_DTIME` VARCHAR,
`DRUG_END_DTIME` VARCHAR,
`DURG_SEND_DTIME` VARCHAR,
`DRUG_USE_DAYS` VARCHAR,
`DRUG_PACKAGE_QTY` VARCHAR,
`DRUG_PACKAGE_UNIT` VARCHAR,
`DRUG_MIN_UNIT` VARCHAR,
`DRUG_BASE_DOSE` VARCHAR,
`DRUG_MAIN_FLAG` VARCHAR,
`GROUP_NO` VARCHAR,
`DRUG_HERB_FOOTNOTES` VARCHAR,
`HERB_DOSE_QTY` VARCHAR,
`CHARGE_FLAG` VARCHAR,
`CHARGE_DTIME` VARCHAR,
`DRUG_SKIN_FLAG` VARCHAR,
`DRUG_SKIN_RESULT` VARCHAR,
`INSPECTION_PART_CODE` VARCHAR,
`INSPECTION_PART_NAME` VARCHAR,
`EMER_FLAG` VARCHAR,
`APPLY_NO` VARCHAR,
`REPORT_NO` VARCHAR,
`NOTE` VARCHAR,
`USE_TIMES` VARCHAR,
`MEDIC_CODE` VARCHAR,
`MEDIC_CODE_SAFETY` VARCHAR,
`MEDIC_SELF` VARCHAR,
`MEDIC_SAFETY` VARCHAR,
`CREATE_DTIME` VARCHAR,
`UPDATE_DTIME` VARCHAR,
`RECORD_DTIME` VARCHAR,
`RECORD_UPDATE_DTIME` VARCHAR,
`DRUG_INTERFACE_CODE` VARCHAR,
`DRUG_INTERFACE_NAME` VARCHAR,
`OLD_RECIPE_DOC_CODE` VARCHAR,
`IFOR_SOURCE` VARCHAR,
`IFOR_IDETIFICATIO_CODE` VARCHAR,
`IFOR_VALID_DATE` VARCHAR,
`IFOR_REVIEWER_AME` VARCHAR,
`IFOR_REVIEWER_ID` VARCHAR,
`IFOR_REVIEW_TIME` DATE,
`IFOR_PRESCRIBE_TIME` DATE,
`IFOR_DISPESE_TIME` DATE,
`IFOR_STATUS` VARCHAR,
`IFOR_ccel_time` DATE,
`IFOR_PRES_FEE` VARCHAR,
`IFOR_PRESCRIBE_EMP_AME` VARCHAR,
`IFOR_PRESCRIBE_EMP_ID` VARCHAR,
`IFOR_DISPESE_EMP_AME` VARCHAR,
`IFOR_DISPESE_EMP_ID` VARCHAR,
`IFOR_REMARK` VARCHAR,
`IFOR_CIRCULATE_FLAG` VARCHAR,
`LIST_CHARGE_ID` VARCHAR,
`LIST_IS_MEDI` VARCHAR,
`LIST_IS_MAI` VARCHAR,
`LIST_TIBIOS_FLAG` VARCHAR,
`LIST_SPIRIT_FLAG` VARCHAR,
`LIST_AESTHETIZTIO` VARCHAR,
`LIST_BASE_FLAG` VARCHAR,
`LIST_VACCIE_FLAG` VARCHAR,
`LIST_IFUSIO_FLAG` VARCHAR,
`LIST_WITHDRAWAL_FLAG` VARCHAR,
`LIST_DOSAGE_FORM` VARCHAR,
`LIST_SPECIFICATIO_UIT` VARCHAR,
`LIST_SPECIFICATIO_` VARCHAR,
`LIST_DISPESE_UMBER` VARCHAR,
`LIST_DISPESE_UIT` VARCHAR,
`LIST_DOSE_UNITNAME` VARCHAR,
`LIST_DOSE_UNITID` VARCHAR,
`LIST_USEUNIT_ID` VARCHAR,
`LIST_IS_SKINTESTDRUG` VARCHAR,
`LIST_REVISE_FLAG` VARCHAR,
`LIST_POISON_FLAG` VARCHAR,
`LIST_POISONMADE_FLAG` VARCHAR,
`LIST_MEDI_TIMING` VARCHAR,
`LIST_DRUGUSE_TOTAL` VARCHAR,
`LIST_DRUG_SOURCE` VARCHAR,
`LIST_MEDI_SPEED` VARCHAR,
`LIST_LIMITED_TIME` VARCHAR,
`LIST_MEDI_PURPOSE` VARCHAR,
`LIST_PROJECT_AMOUNT` VARCHAR,
`LIST_ANTI_TUMOR_DRUG` VARCHAR,
`AUTO_ID` VARCHAR,
`isUpload` INT,
`isValidate` INT,
`rbusiness_date` TIMESTAMP(3),
PRIMARY KEY (`AUTO_ID`) NOT ENFORCED
)
 WITH (
'connector' = 'jdbc',
'url' = 'jdbc:mysql://localhost:3306/ods?useSSL=false&autoReconnect=true',
'table-name' = 'S_CLI_RECIPE',
'username' = 'ruisoft',
'password' = 'Ruisoft@123',
'driver' = 'com.mysql.jdbc.Driver')
]]></sql>
    <sql name="queryCF">
        <![CDATA[
SELECT (SELECT VVALUE
        FROM SYSVAR
        WHERE VNAME = 'ORG_CODE' AND CHAR_LENGTH(VVALUE) = 8 LIMIT 1)                                AS ORG_CODE,                 --2022年6月21日10:04:32
       DP_CONCAT(E.PRES_ID, '-', E.`NO`, '-', E.GROUPNO, '-1')                                       AS AUTO_ID,                  --序列号
       DP_CONCAT(E.PRES_ID, '-', E.`NO`, '-', E.GROUPNO, '-1')                                       AS LP_CLI_RECIPE,            --主键-门诊处方业务
       E.PRES_ID                                                                                       AS LK_CLI_RECIPE,            --关联键-门诊处方业务
       F.REGISTER_ID                                                                                   AS LK_CLI_SEE,               --关联键-门诊就诊业务
       F.SICK_ID                                                                                       AS LK_MPI_PATIENT,           --关联键-患者业务
       F.SICK_ID                                                                                       AS PATIENT_ID,               --患者号
       F.REGISTER_ID                                                                                   AS OUTP_ID,                  --门诊号
       F.REGISTER_ID                                                                                   AS OUTP_NO,                  --门诊就诊流水号
       DP_CONCAT(E.PRES_ID, '-', C.CATEGORY)                                                           AS RECIPE_NO,                --处方号
       C.RECORD_TIME                                                                                   AS RECIPE_DTIME,             --处方时间
       F.DEPT_ID                                                                                       AS RECIPE_DEPT_CODE,         --开立科室代码
       (SELECT MC FROM KSMC WHERE `NO` = CAST(F.DEPT_ID AS STRING))                                            AS RECIPE_DEPT_NAME,         --开立科室名称
       F.EMP_ID                                                                                        AS RECIPE_DOC_CODE,          --开立医生代码
       (SELECT XM FROM ZGXX WHERE ID = F.EMP_ID)                                             AS RECIPE_DOC_NAME,          --开立医生名称
       '1'                                                                                             AS DRUG_FLAG,                --药品标识
       E.DRUG_ID                                                                                       AS ITEM_CODE,                --项目代码
       D.HZMC                                                                                          AS ITEM_NAME,                --项目名称
       NVL(C.TYPE, 'Q')                                                                                AS ITEM_TYPE_CODE,           --项目类别代码
       DP_DECODE(C.TYPE, 'Y', '西药', 'Z', '成药', 'C', '中药', 'M', '免煎', 'G', '膏方',
                 '其他')                                                                                 AS ITEM_TYPE_NAME,           --项目类别名称
       D.LSJ                                                                                           AS UNIT_PRICE,               --单价
       E.QUANTITY                                                                                      AS QTY,                      --数量
       D.DW2                                                                                           AS UNIT,                     --计价单位
       D.GG                                                                                            AS SPEC,                     --规格
       C.CATEGORY                                                                                      AS DRUG_RECP_TYPECODE,       --处方类型代码
       (SELECT TITLE FROM CFFL WHERE XH = C.CATEGORY)                                        AS DRUG_RECP_TYPENAME,       --处方类型名称
       E.USAGE                                                                                         AS DRUG_USE_FREQCODE,        --使用频次代码
       (SELECT MC FROM YZYFB WHERE DM = B.YF)                                                AS DRUG_USE_FREQNAME,        --使用频次名称
       E.DOSE                                                                                          AS DRUG_EACH_DOSE,           --药品每次使用剂量
       D.JLDW                                                                                          AS DRUG_DOSE_UNIT,           --剂量单位
       E.DRUG_WAY                                                                                      AS DRUG_USAGE_CODE,          --药品使用用法代码
       (SELECT MC FROM GYFSB WHERE DM = E.DRUG_WAY)                                          AS DRUG_USAGE_NAME,          --药品使用用法名称
       D.JX                                                                                            AS DOSAGE_FORM_CODE,         --药品剂型代码
       (SELECT MC FROM YPJX WHERE `NO` = D.JX)                                                 AS DOSAGE_FORM_NAME,         --药品剂型名称
       E.QUANTITY                                                                                      AS DRUG_TOTAL_DOSE,          --药品使用总剂量
       D.DW2                                                                                           AS DRUG_TOTAL_UNIT,          --药品使用总剂量单位
       ''                                                                                              AS DRUG_START_DTIME,         --用药开始时间
       ''                                                                                              AS DRUG_END_DTIME,           --用药停止时间
       A.FYSJ                                                                                          AS DURG_SEND_DTIME,          --发药时间
       ROUND((SELECT TS / NUM FROM YZYFB WHERE DM = B.YF) * E.TIMES,
             2)                                                                                        AS DRUG_USE_DAYS,            --药品使用天数
       D.SL2                                                                                           AS DRUG_PACKAGE_QTY,         --药品包装数量
       D.DW                                                                                            AS DRUG_PACKAGE_UNIT,        --药品包装单位
       ''                                                                                              AS DRUG_MIN_UNIT,            --最小单位
       ''                                                                                              AS DRUG_BASE_DOSE,           --药品基本剂量
       DP_DECODE(E.IS_MAIN, 'Y', '1', '2')                                                             AS DRUG_MAIN_FLAG,           --主药标志
       DP_CONCAT(E.PRES_ID, '-', E.`NO`, '-', E.GROUPNO)                                                 AS GROUP_NO,                 --组合号
       ''                                                                                              AS DRUG_HERB_FOOTNOTES,      --草药脚注
       E.TIMES                                                                                         AS HERB_DOSE_QTY,            --药品付数
       CASE WHEN C.CHARGE_ID IS NOT NULL THEN '1' ELSE '2' END                                         AS CHARGE_FLAG,              --是否收费
       G.FSSJ                                                                                          AS CHARGE_DTIME,             --收费时间
       DP_DECODE(D.PSBJ, 'Y', '1', 'N', '2', '2')                                                      AS DRUG_SKIN_FLAG,           --皮试判别标识
       DP_DECODE(E.SKIN_TEST,
                 '+',
                 '阳',
                 '-',
                 '阴',
                 'W',
                 '未',
                 'M',
                 '免',
                 'T',
                 '脱敏',
                 '')                                                                                   AS DRUG_SKIN_RESULT,         --皮试结果
       ''                                                                                              AS INSPECTION_PART_CODE,     --检查部位代码
       ''                                                                                              AS INSPECTION_PART_NAME,     --检查部位名称
       ''                                                                                              AS EMER_FLAG,                --加急标志
       ''                                                                                              AS APPLY_NO,                 --申请单号
       ''                                                                                              AS REPORT_NO,                --报告单号
       C.DEMAND                                                                                        AS NOTE,                     --备注
       ''                                                                                              AS USE_TIMES,                -- 使用频率
       D.CDMC                                                                                          AS PRODUCTION_PLACE,         --生产产地
       ''                                                                                              AS PRODUCTION_DTIME,         --生产日期
       ''                                                                                              AS VALID_DTIME,              --有效日期
       B.DM                                                                                            AS MEDIC_CODE,               --	中心药品代码--------------------------------------------------上报市平台处理
       NVL(D.YBYPBM, '999')                                                                            AS MEDIC_CODE_SAFETY,        --	医保代码
       E.SELF_MARK                                                                                     AS MEDIC_SELF,               --	自备  默认N
       E.MED_INS_MARK                                                                                  AS MEDIC_SAFETY,             --	医保自负  默认N
       C.RECORD_TIME                                                                                   AS CREATE_DTIME,             --业务数据创建时间
       C.RECORD_TIME                                                                                   AS UPDATE_DTIME,             --业务数据更新时间
       ''                                                                                              AS RECORD_DTIME,             --记录时间
       ''                                                                                              AS RECORD_UPDATE_DTIME,      --记录更新时间
       '3'                                                                                             AS INFOR_SOURCE,--	处方来源	S3	AN..2	Y	处方来源代码 NBC01.01.027	20211210新增
       DP_DECODE(C.CATEGORY, '2', '1', '3', '2', '7', '3', '8', '3', '9', '5', '10', '5',
              '9')                                                                                     AS INFOR_IDENTIFICATION_CODE,--	处方辨识代码	S3	AN..50	Y	处方辨识代码 NBC01.01.026	20211210新增
       NVL(ROUND((SELECT TS / NUM FROM YZYFB WHERE DM = B.YF) * E.TIMES, 2),
           '1')                                                                                        AS INFOR_VALID_DATE,--	处方有效天数	N	N..4	Y	指处方超过多少天就不能核销（用于院内审核发药，外配药店发药）。	20211210新增
       (SELECT XM FROM ZGXX WHERE ID = A.FYRY)                                               AS INFOR_REVIEWER_NAME,--	处方审核药剂师姓名	S1	AN..50	Y		20211210新增
       (SELECT XM FROM ZGXX WHERE ID = A.FYRY)                                               AS INFOR_REVIEWER_ID,--	处方审核药剂师id	S3	N..10		中心人员库 NBD03.00.001	20211210新增 --------------------------------------------------上报市平台处理
       A.FYSJ                                                                                          AS INFOR_REVIEW_TIME,--	处方审核时间	D	DT15			20211210新增
       A.PYSJ                                                                                          AS INFOR_PRESCRIBE_TIME,--	配药时间	D	DT15			20211210新增
       A.FYSJ                                                                                          AS INFOR_DISPENSE_TIME,--	发药时间	D	DT15	Y		20211210新增
       '0'                                                                                             AS INFOR_STATUS,--	处方状态	S3	AN..2	Y	处方状态代码 NBC01.01.025	20211210新增，20220419字典扩增
       CAST(NULL AS TIMESTAMP)                                                                                            AS INFOR_cancel_time,--	作废时间	D	DT15			20211215新增
       (SELECT SUM(JE) FROM MZCFMXXX WHERE `NO` = A.`NO`)                                        AS INFOR_PRES_FEE,--	处方金额	N	N..20	Y	处方计价金额，单位为分	20220419新增
       (SELECT XM FROM ZGXX WHERE ID = A.PYRY)                                               AS INFOR_PRESCRIBE_EMP_NAME,--	处方调配药剂师姓名	S1	AN..50		对门急诊处方进行调配的药剂师签署的在公安户籍管理部门正式登记注册的姓氏和名称	20220419新增
       (SELECT XM FROM ZGXX WHERE ID = A.PYRY)                                               AS INFOR_PRESCRIBE_EMP_ID,--	处方调配药剂师编号	S1	AN..50		中心人员库 NBD03.00.001	20220419新增--------------------------------------------------上报市平台处理
       (SELECT XM FROM ZGXX WHERE ID = A.FYRY)                                               AS INFOR_DISPENSE_EMP_NAME,--	处方发药药剂师姓名	S1	AN..50		按照审核、调配后的门急诊处方，给患者发药的药剂师签署的在公安户籍管理部门正式登记注册的姓氏和名称	20220419新增
       (SELECT XM FROM ZGXX WHERE ID = A.FYRY)                                               AS INFOR_DISPENSE_EMP_ID,--	处方发药药剂师编号	S1	AN..50		中心人员库 NBD03.00.001	20220419新增--------------------------------------------------上报市平台处理
       C.DEMAND                                                                                        AS INFOR_REMARK,--	处方备注信息	S1	AN..2000		对处方信息的重要提示和补充说明	20220419新增

       CAST(NULL AS INTEGER)                                                                                            AS INFOR_CIRCULATE_FLAG,--	允许流转标志	S2	N1		1. 允许流转 2.不允许流转	20220419新增
       A.SFNO                                                                                          AS LIST_CHARGE_ID,--	收费号	N	AN..20	Y	与门诊收费表ORG_CHARGE_ID保持一致
       '1'                                                                                             AS LIST_IS_MEDI,--	是否药品	S3	AN..2	Y	是否代码表 NBP00.00.006	20211210新增
       DP_DECODE(E.IS_MAIN, 'Y', '1', '2')                                                                AS LIST_IS_MAIN,--	是否主药	S3	AN..2	Y	是否代码表 NBP00.00.006，输液处方，溶药为主药	20211210新增
       CASE WHEN D.KSSJB > 0 THEN '1' ELSE '2' END                                                     AS LIST_ANTIBIOS_FLAG,--	抗菌药物标志	S3	AN..2	Y	抗生素级别代码表 NBD06.00.011	20211210新增
       CASE
           WHEN D.YPGLBZ = 'J' AND D.TSYPDJ = '1' THEN '1'
           WHEN D.YPGLBZ = 'J' AND D.TSYPDJ = '2' THEN '2'
           WHEN D.YPGLBZ = 'J' AND D.TSYPDJ NOT IN ('1', '2') THEN '9'
           ELSE '8' END                                                                                AS LIST_SPIRIT_FLAG,--	精神药物标志	S3	AN..2		精神药物代码表 NBC01.01.032	20211213新增
       DP_DECODE(D.YPGLBZ, 'M', '1', '2')                                                                 AS LIST_ANAESTHETIZTION,--	麻醉药物标志	S3	AN..2	Y	是否代码表 NBP00.00.006	20211210新增
       (SELECT DP_DECODE(JBYW, 'Y', '1', '2')
        FROM YPMCQT
        WHERE YPBH = B.DM)                                                                             AS LIST_BASE_FLAG,--	基本药物标志	S3	AN..2	Y	基药标志代码 NBC01.01.033	20211210新增
       CASE
           WHEN (SELECT YMZLDM FROM YPMCQT WHERE YPBH = B.DM) IS NULL THEN '2'
           ELSE '1' END                                                                                AS LIST_VACCINE_FLAG,--	疫苗标志	S3	AN..2	Y	是否代码表 NBP00.00.006	20211210新增
       DP_DECODE(D.YPGLBZ, 'S', '1', '2')                                                                 AS LIST_INFUSION_FLAG,--	输液用药标志	S3	AN..2	Y	是否代码表 NBP00.00.006	20211210新增
       CASE WHEN B.SL < 0 THEN '1' ELSE '2' END                                                        AS LIST_WITHDRAWAL_FLAG,--	退药标志	S3	AN..2	Y	是否代码表 NBP00.00.006	20211210新增
       (SELECT MC FROM YPJX WHERE `NO` = D.JX)                                                 AS LIST_DOSAGE_FORM,--	药物剂型代码	S3	AN..3	Y	药物剂型代码 NBC01.01.028	20211210新增	--------------------------------------------------值域转换
       D.DW                                                                                            AS LIST_SPECIFICATION_UNIT,--	药品包装规格单位	S1	AN..30	Y	药品包装规格单位，若是药品，必填。发药包装单位，例如：瓶、盒。对于医院自定义的包装，可以提供自定义的包装单位。	20211210新增
       D.SL2                                                                                           AS LIST_SPECIFICATION_,--	药品包装规格系数	S1	AN..30	Y	若是药品，必填。例如：12支/每盒中的12 ，是指每盒中有12支。这里的12是指当前包装中有12个药品规格字段中的装量单位“支”的数量。对于医院自定义的包装，请提供自定义的包装中包含的最小装量单位的数量，比如包装中包含有6支，其值就为6。	20211210新增
       B.SL                                                                                            AS LIST_DISPENSE_NUMBER,--	发药数量	N	N..8,2	Y		20211210新增
       D.DW2                                                                                           AS LIST_DISPENSE_UNIT,--	发药单位	S1	AN..6	Y		20211210新增
       D.JLDW                                                                                          AS LIST_DOSE_UNITNAME,--	剂量单位名称	S1	AN..16	Y		20211210新增
       D.JLDW                                                                                          AS LIST_DOSE_UNITID,--	剂量单位代码	S3	AN..16	Y	药物剂量单位代码 NBC01.01.029	20211210新增	--------------------------------------------------值域转换
       D.DW1                                                                                           AS LIST_USEUNIT_ID,--	用量单位代码	S3	AN..6	Y	药物用量单位代码 NBC01.01.030	20211210新增--------------------------------------------------值域转换
       DP_DECODE(D.PSBJ, 'Y', '1', '2')                                                                   AS LIST_IS_SKINTESTDRUG,--	是否皮试药品	S3	AN..2	Y	是否代码表 NBP00.00.006	20211210新增
       '0'                                                                                             AS LIST_REVISE_FLAG,--	修改标志	S3	AN..2	Y	正常作废代码 NBC01.01.031	20211210新增
       DP_DECODE(D.YPGLBZ, 'D', '1', '2')                                                                 AS LIST_POISON_FLAG,--	毒性药物标志	S2	N1		是否代码表 NBP00.00.006	20220419新增
       DP_DECODE(D.YPGLBZ, 'D', '1', '2')                                                                 AS LIST_POISONMADE_FLAG,--	易制毒药物标志	S2	N1		是否代码表 NBP00.00.006	20220419新增
       CAST(NULL AS STRING)                                                                                              AS LIST_MEDI_TIMING,--	给药时机	S1	AN..50		给药时机，如：饭前、饭后、空腹等	20220419新增
       B.SL * D.SL1                                                                                    AS LIST_DRUGUSE_TOTAL,--	药物使用总剂量	N	N..10,4		药物使用总剂量	20220419新增
       DP_DECODE(B.ZBBZ, 'Y', '2', '1')                                                                   AS LIST_DRUG_SOURCE,--	药品来源代码	S2	N1		1.医院药品 2.自备药品	20220419新增
       CAST(NULL AS INTEGER)                                                                                            AS LIST_MEDI_SPEED,--	给药速度	S1	AN..20		给药速度，静脉输液药品滴注时间和速度的描述，如：1小时、20滴/分钟，需同时传入数字和单位，单位为小时或滴/分钟	20220419新增
       CAST(NULL AS TIMESTAMP)                                                                                            AS LIST_LIMITED_TIME,--	限用时间	S1	AN..20		限用时间，静脉输液药品配制后使用时间的描述，如：现配现用、立即使用、2h内使用等	20220419新增
       CAST(NULL AS STRING)                                                                                               AS LIST_MEDI_PURPOSE,--	药嘱目的	S1	AN..50		药嘱目的，（药嘱开具的目的，科室领药、带手术室等）	20220419新增
       B.JE                                                                                            AS LIST_PROJECT_AMOUNT,--	项目金额	N	N..10		项目金额，单位：分	20220419新增
       CASE
           WHEN (SELECT KZLYP FROM YPMCQT WHERE YPBH = B.DM) > 0 THEN '1'
           ELSE '2' END                                                                                AS LIST_ANTI_TUMOR_DRUG      --	抗肿瘤药物标志	S2	N1	Y	是否代码表 NBP00.00.006	20220516新增
FROM MZCFXX A
   , MZCFMXXX B
         LEFT JOIN YPMC D ON B.DM = D.YPBH
   , KTDOC_PRESCRIPTION C
   , KTDOC_PRESCRIPTION_LIST E
   , KTDOC_WORK_LOG F
   , MZSFXX G
WHERE A.`NO` = B.`NO`
  AND A.KFDM = B.KFDM
  AND A.LX = B.LX
  AND A.`NO` = C.FEE_PRES_ID
  AND A.SFNO = G.`NO`
  AND G.MZH = F.REGISTER_ID
  AND F.CLINIC_ID = C.CLINIC_ID
  AND C.PRES_ID = E.PRES_ID
  AND B.DM = E.DRUG_ID
  AND B.ZH = E.GROUPNO
        ]]>
    </sql>
    <sql name="queryCLI">
        <![CDATA[
SELECT DP_CONCAT(A.CLINIC_ID,'-',A.EMP_ID) AS AUTO_ID, --  源表物理主键
       DP_CONCAT(A.CLINIC_ID,'-',A.EMP_ID ) AS LP_CLI_SEE, --  主键-门诊就诊业务
       A.REGISTER_ID AS LK_CLI_SEE, --  关联键-门诊就诊业务
       A.REGISTER_ID AS LK_CLI_REG, --  关联键-门诊挂号业务
       B.BRBH AS LK_MPI_PATIENT, --  关联键-患者业务
       B.BRBH AS PATIENT_ID, --  患者标识
       A.CLINIC_ID AS OUTP_ID, --  门诊号
       A.REGISTER_ID AS OUTP_NO, --  门诊就诊流水号
       B.BRXM AS NAME, --  患者姓名
       A.DEPT_ID AS CLI_DEPT_CODE, --  就诊科室代码
      (SELECT MC FROM KSMC WHERE `NO` = A.DEPT_ID) AS CLI_DEPT_NAME, --  就诊科室名称
       A.START_TIME AS CLI_DTIME, --  就诊时间
       A.EMP_ID AS CLI_DOCT_CODE, --  医生代码
       (SELECT XM FROM ZGXX WHERE ID = A.EMP_ID)  AS CLI_DOCT_NAME, --  医生名称
       (SELECT C.ICD FROM KTDOC_DIAGNOSE C WHERE C.CLINIC_ID=A.CLINIC_ID AND C.`NO` = 1) AS DIAG_CODE, --  诊断编码
       (SELECT C.DISEASE_NAME FROM KTDOC_DIAGNOSE C WHERE C.CLINIC_ID=A.CLINIC_ID AND C.`NO` = 1) AS DIAG_NAME, --  诊断名称
       '' AS CHIEF_COMPLIANT, --  主诉
       A.SYSPTOM_CODE AS SYMPTOM_CODE, --  症状代码
       REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(A.SYSPTOM_CODE,'00','无下列症状'),'01','发热（低热）'),'02','发热（中热）'),'03','发热（高热）'),'04','发热（超高热）'),'05','腹泻'),'06','呕吐'),'07','皮疹'),'08','红眼'),'09','腮腺肿大'),'10','流感样症状'),'11','神经系统') AS SYMPTOM_NAME, --  症状名称
       '' AS MEDICAL_HISTORY, --  病史
       '' AS ALLERGIC_HISTORY, --  过敏史
       '' AS CHECK_UP, --  查体
       '' AS TREATMENT_PLAN, --  处置意见
       '' AS SBP, --  收缩压(MMHG)
       '' AS DBP, --  舒张压(MMHG)
(SELECT SUBSTR(REMARKS,INSTR(REMARKS,'身高')+3,INSTR(REMARKS,'cm')-INSTR(REMARKS,'身高')-1) FROM KTDOC_CASE_HISTORY WHERE `FIELD` = 'JCSJ' AND CLINIC_ID = A.CLINIC_ID) AS HEIGHT, --  身高(CM)
(SELECT SUBSTR(REMARKS,INSTR(REMARKS,'体重')+3,INSTR(REMARKS,'kg')-INSTR(REMARKS,'体重')-1) FROM KTDOC_CASE_HISTORY WHERE `FIELD` = 'JCSJ' AND CLINIC_ID = A.CLINIC_ID) AS WEIGHT, --  体重(KG)
       '' AS CONSULT_QUESTION, --  咨询问题
       '' AS HEALTH_REQUEST, --  卫生服务要求
       '' AS HEALTH_EVALUATION, --  健康问题评估
       '' AS OTHER_MEDICAL_TREATMENT, --  其他医学处置
       '' AS DIAG_CODING_TYPE, --  编码类型
       '' AS DIAG_NOTE, --  门诊诊断说明
       '' AS REFERRAL_FLAG, --  转诊标志
       '' AS REFERRAL_NOTE, --  转诊说明
       '' AS OTHER_DIAG_CODE, --   次诊断编码
       '' AS OTHER_DIAG_NAME, --  次诊断名称
       '' AS INFECTIOUS_FLAG, --  传染病标志
       DP_DECODE(A.CHRONIC, 'N', '2', '1') AS CHRONIC_FLAG, --   慢病标志
 (SELECT max(SUBSTR(REMARKS,INSTR(REMARKS,'体温')+3,INSTR(REMARKS,'℃')-INSTR(REMARKS,'体温')-3)) FROM KTDOC_CASE_HISTORY WHERE CLINIC_ID = A.CLINIC_ID) AS TEMP, --   体温
       '' AS PULSE_CONDITION, --  脉象
       '' AS HEART_RATE, --   心率
       '' AS PAST_HISTORY, --   既往史
       A.SICKEN_TIME AS GETILL_DTIME, --   发病日期
       '' AS DIAG_DTIME, --   诊断日期
       A.`RESULT` AS PATIENT_GONE, --   病人去向
       '' AS PATIENT_GONE_OTHER, --   病人其他去向详述
A.END_TIME AS CLINIC_END_TIME,--诊毕时间
       '' AS OUTHOS_RESULT_CODE, --   治疗结果代码(转归)
       '' AS OUTHOS_RESULT_NAME, --   治疗结果名称(转归)
       A.START_TIME AS CREATE_DTIME, --  业务数据创建时间
       A.START_TIME AS UPDATE_DTIME, --  业务数据更新时间
       '' AS RECORD_DTIME,
       '' AS RECORD_UPDATE_DTIME
FROM KTDOC_WORK_LOG A, MZGHXX B
WHERE A.REGISTER_ID=B.MZH
    AND   B.BRBH=A.SICK_ID
AND A.BRANCH_CODE='00'
        ]]>
    </sql>
    <sql name="insertCF">
        <![CDATA[
insert into S_CLI_RECIPE (AUTO_ID, PATIENT_ID, OUTP_ID, OUTP_NO, RECIPE_NO, RECIPE_DTIME,
                          RECIPE_DEPT_CODE, RECIPE_DEPT_NAME, RECIPE_DOC_CODE, RECIPE_DOC_NAME, DRUG_FLAG, ITEM_CODE,
                          ITEM_NAME, ITEM_TYPE_CODE, ITEM_TYPE_NAME, UNIT_PRICE, QTY, UNIT, SPEC, DRUG_RECP_TYPECODE,
                          DRUG_RECP_TYPENAME, DRUG_USE_FREQCODE, DRUG_USE_FREQNAME, DRUG_EACH_DOSE, DRUG_DOSE_UNIT,
                          DRUG_USAGE_CODE, DRUG_USAGE_NAME, DOSAGE_FORM_CODE, DOSAGE_FORM_NAME, DRUG_TOTAL_DOSE,
                          DRUG_TOTAL_UNIT, DRUG_START_DTIME, DRUG_END_DTIME, DURG_SEND_DTIME, DRUG_USE_DAYS,
                          DRUG_PACKAGE_QTY, DRUG_PACKAGE_UNIT, DRUG_MIN_UNIT, DRUG_BASE_DOSE, DRUG_MAIN_FLAG, GROUP_NO,
                          DRUG_HERB_FOOTNOTES, HERB_DOSE_QTY, CHARGE_FLAG, CHARGE_DTIME, DRUG_SKIN_FLAG,
                          DRUG_SKIN_RESULT, INSPECTION_PART_CODE, INSPECTION_PART_NAME, EMER_FLAG, APPLY_NO, REPORT_NO,
                          NOTE, USE_TIMES, MEDIC_CODE, MEDIC_CODE_SAFETY, MEDIC_SELF, MEDIC_SAFETY, CREATE_DTIME,
                          UPDATE_DTIME, RECORD_DTIME, RECORD_UPDATE_DTIME,
                          LIST_CHARGE_ID,
                          LIST_IS_MEDI, LIST_SPIRIT_FLAG,
                          LIST_BASE_FLAG, LIST_WITHDRAWAL_FLAG, LIST_DOSAGE_FORM,
                          LIST_DOSE_UNITNAME, LIST_DOSE_UNITID, LIST_USEUNIT_ID, LIST_IS_SKINTESTDRUG, LIST_REVISE_FLAG,
                          LIST_POISON_FLAG, LIST_POISONMADE_FLAG, LIST_MEDI_TIMING, LIST_DRUGUSE_TOTAL, LIST_DRUG_SOURCE,
                          LIST_MEDI_SPEED, LIST_LIMITED_TIME, LIST_MEDI_PURPOSE, LIST_PROJECT_AMOUNT, LIST_ANTI_TUMOR_DRUG)
SELECT CAST(AUTO_ID AS STRING),
CAST(PATIENT_ID AS STRING),
CAST(OUTP_ID AS STRING),
CAST(OUTP_NO AS STRING),
CAST(RECIPE_NO AS STRING),
CAST(RECIPE_DTIME AS STRING),
CAST(RECIPE_DEPT_CODE AS STRING),
CAST(RECIPE_DEPT_NAME AS STRING),
CAST(RECIPE_DOC_CODE AS STRING),
CAST(RECIPE_DOC_NAME AS STRING),
CAST(DRUG_FLAG AS STRING),
CAST(ITEM_CODE AS STRING),
CAST(ITEM_NAME AS STRING),
CAST(ITEM_TYPE_CODE AS STRING),
CAST(ITEM_TYPE_NAME AS STRING),
CAST(UNIT_PRICE AS STRING),
CAST(QTY AS STRING),
CAST(UNIT AS STRING),
CAST(SPEC AS STRING),
CAST(DRUG_RECP_TYPECODE AS STRING),
CAST(DRUG_RECP_TYPENAME AS STRING),
CAST(DRUG_USE_FREQCODE AS STRING),
CAST(DRUG_USE_FREQNAME AS STRING),
CAST(DRUG_EACH_DOSE AS STRING),
CAST(DRUG_DOSE_UNIT AS STRING),
CAST(DRUG_USAGE_CODE AS STRING),
CAST(DRUG_USAGE_NAME AS STRING),
CAST(DOSAGE_FORM_CODE AS STRING),
CAST(DOSAGE_FORM_NAME AS STRING),
CAST(DRUG_TOTAL_DOSE AS STRING),
CAST(DRUG_TOTAL_UNIT AS STRING),
CAST(DRUG_START_DTIME AS STRING),
CAST(DRUG_END_DTIME AS STRING),
CAST(DURG_SEND_DTIME AS STRING),
CAST(DRUG_USE_DAYS AS STRING),
CAST(DRUG_PACKAGE_QTY AS STRING),
CAST(DRUG_PACKAGE_UNIT AS STRING),
CAST(DRUG_MIN_UNIT AS STRING),
CAST(DRUG_BASE_DOSE AS STRING),
CAST(DRUG_MAIN_FLAG AS STRING),
CAST(GROUP_NO AS STRING),
CAST(DRUG_HERB_FOOTNOTES AS STRING),
CAST(HERB_DOSE_QTY AS STRING),
CAST(CHARGE_FLAG AS STRING),
CAST(CHARGE_DTIME AS STRING),
CAST(DRUG_SKIN_FLAG AS STRING),
CAST(DRUG_SKIN_RESULT AS STRING),
CAST(INSPECTION_PART_CODE AS STRING),
CAST(INSPECTION_PART_NAME AS STRING),
CAST(EMER_FLAG AS STRING),
CAST(APPLY_NO AS STRING),
CAST(REPORT_NO AS STRING),
CAST(NOTE AS STRING),
CAST(USE_TIMES AS STRING),
CAST(MEDIC_CODE AS STRING),
CAST(MEDIC_CODE_SAFETY AS STRING),
CAST(MEDIC_SELF AS STRING),
CAST(MEDIC_SAFETY AS STRING),
CAST(CREATE_DTIME AS STRING),
CAST(UPDATE_DTIME AS STRING),
CAST(RECORD_DTIME AS STRING),
CAST(RECORD_UPDATE_DTIME AS STRING),
CAST(LIST_CHARGE_ID AS STRING),
CAST(LIST_IS_MEDI AS STRING),
CAST(LIST_SPIRIT_FLAG AS STRING),
CAST(LIST_BASE_FLAG AS STRING),
CAST(LIST_WITHDRAWAL_FLAG AS STRING),
CAST(LIST_DOSAGE_FORM AS STRING),
CAST(LIST_DOSE_UNITNAME AS STRING),
CAST(LIST_DOSE_UNITID AS STRING),
CAST(LIST_USEUNIT_ID AS STRING),
CAST(LIST_IS_SKINTESTDRUG AS STRING),
CAST(LIST_REVISE_FLAG AS STRING),
CAST(LIST_POISON_FLAG AS STRING),
CAST(LIST_POISONMADE_FLAG AS STRING),
CAST(LIST_MEDI_TIMING AS STRING),
CAST(LIST_DRUGUSE_TOTAL AS STRING),
CAST(LIST_DRUG_SOURCE AS STRING),
CAST(LIST_MEDI_SPEED AS STRING),
CAST(LIST_LIMITED_TIME AS STRING),
CAST(LIST_MEDI_PURPOSE AS STRING),
CAST(LIST_PROJECT_AMOUNT AS STRING),
CAST(LIST_ANTI_TUMOR_DRUG  AS STRING)
from DTable
        ]]>
    </sql>
    <sql name="insertCLI">
        <![CDATA[

        ]]>
    </sql>
    <sql name="queryTest">
        <![CDATA[
SELECT (SELECT VVALUE
        FROM SYSVAR
        WHERE VNAME = 'ORG_CODE' AND CHAR_LENGTH(VVALUE) = 8 LIMIT 1)                                AS ORG_CODE,                 --2022年6月21日10:04:32

       A.FYSJ                                                                                          AS DURG_SEND_DTIME,          --发药时间

       B.DM                                                                                            AS MEDIC_CODE,               --	中心药品代码--------------------------------------------------上报市平台处理
       A.FYSJ                                                                                          AS INFOR_REVIEW_TIME,--	处方审核时间	D	DT15			20211210新增
       A.PYSJ                                                                                          AS INFOR_PRESCRIBE_TIME,--	配药时间	D	DT15			20211210新增
       A.FYSJ                                                                                          AS INFOR_DISPENSE_TIME,--	发药时间	D	DT15	Y		20211210新增
       '0'                                                                                             AS INFOR_STATUS--	处方状态	S3	AN..2	Y	处方状态代码 NBC01.01.025	20211210新增，20220419字典扩增

FROM MZCFXX AS A
    JOIN MZCFMXXX AS B
ON A.`NO` = B.`NO`
  AND A.KFDM = B.KFDM
  AND A.LX = B.LX
        ]]>
    </sql>

    <sql name="selectHIS">
        <![CDATA[
SELECT (SELECT VVALUE FROM HMISW2003.SYSVAR WHERE VNAME = 'ORG_CODE' AND LENGTH(VVALUE) = 8 AND ROWNUM = 1) AS ORG_CODE,   --2022年6月21日10:04:32
       E.PRES_ID || '-' || E.NO || '-' || E.GROUPNO||'-1' AS AUTO_ID, --序列号
       E.PRES_ID || '-' || E.NO || '-' || E.GROUPNO||'-1'  AS LP_CLI_RECIPE, --主键-门诊处方业务
       E.PRES_ID AS LK_CLI_RECIPE, --关联键-门诊处方业务
       F.REGISTER_ID AS LK_CLI_SEE, --关联键-门诊就诊业务
       F.SICK_ID AS LK_MPI_PATIENT, --关联键-患者业务
       F.SICK_ID AS PATIENT_ID, --患者号
       F.REGISTER_ID AS OUTP_ID, --门诊号
       F.REGISTER_ID AS OUTP_NO, --门诊就诊流水号
       E.PRES_ID||'-'||C.CATEGORY AS RECIPE_NO, --处方号
       C.RECORD_TIME AS RECIPE_DTIME, --处方时间
       F.DEPT_ID AS RECIPE_DEPT_CODE, --开立科室代码
       (SELECT MC FROM HMISW2003.KSMC WHERE NO = F.DEPT_ID) AS RECIPE_DEPT_NAME, --开立科室名称
       F.EMP_ID AS RECIPE_DOC_CODE, --开立医生代码
       (SELECT XM FROM HMISW2003.ZGXX WHERE ID = F.EMP_ID) AS RECIPE_DOC_NAME, --开立医生名称
       '1' AS DRUG_FLAG, --药品标识
       E.DRUG_ID AS ITEM_CODE, --项目代码
       D.HZMC AS ITEM_NAME, --项目名称
       NVL(C.TYPE,'Q') AS ITEM_TYPE_CODE, --项目类别代码
       DECODE(C.TYPE,'Y','西药','Z','成药','C','中药','M','免煎','G','膏方','其他') AS ITEM_TYPE_NAME, --项目类别名称
       D.LSJ AS UNIT_PRICE, --单价
       E.QUANTITY AS QTY, --数量
       D.DW2 AS UNIT, --计价单位
       D.GG AS SPEC, --规格
       C.CATEGORY AS DRUG_RECP_TYPECODE, --处方类型代码
       (SELECT TITLE FROM HMISW2003.CFFL WHERE XH = C.CATEGORY) AS DRUG_RECP_TYPENAME, --处方类型名称
       E.USAGE AS DRUG_USE_FREQCODE, --使用频次代码
       (SELECT MC FROM HMISW2003.YZYFB WHERE DM = B.YF) AS DRUG_USE_FREQNAME, --使用频次名称
       E.DOSE AS DRUG_EACH_DOSE, --药品每次使用剂量
       D.JLDW AS DRUG_DOSE_UNIT, --剂量单位
       E.DRUG_WAY AS DRUG_USAGE_CODE, --药品使用用法代码
       (SELECT MC FROM HMISW2003.GYFSB WHERE DM = E.DRUG_WAY) AS DRUG_USAGE_NAME, --药品使用用法名称
       D.JX AS DOSAGE_FORM_CODE, --药品剂型代码
       (SELECT MC FROM HMISW2003.YPJX WHERE NO = D.JX) AS DOSAGE_FORM_NAME, --药品剂型名称
       E.QUANTITY AS DRUG_TOTAL_DOSE, --药品使用总剂量
       D.DW2 AS DRUG_TOTAL_UNIT, --药品使用总剂量单位
       '' AS DRUG_START_DTIME, --用药开始时间
       '' AS DRUG_END_DTIME, --用药停止时间
       A.FYSJ AS DURG_SEND_DTIME, --发药时间
       ROUND((SELECT TS/NUM FROM HMISW2003.YZYFB WHERE DM = B.YF)*E.TIMES,2) AS DRUG_USE_DAYS, --药品使用天数
       D.SL2 AS DRUG_PACKAGE_QTY, --药品包装数量
       D.DW AS DRUG_PACKAGE_UNIT, --药品包装单位
       ''  AS DRUG_MIN_UNIT, --最小单位
       '' AS DRUG_BASE_DOSE, --药品基本剂量
       DECODE(E.IS_MAIN,'Y','1','2') AS DRUG_MAIN_FLAG, --主药标志
       E.PRES_ID || '-' || E.NO || '-' || E.GROUPNO AS GROUP_NO, --组合号
       '' AS DRUG_HERB_FOOTNOTES, --草药脚注
       E.TIMES AS HERB_DOSE_QTY, --药品付数
       CASE WHEN C.CHARGE_ID IS NOT NULL THEN '1' ELSE '2' END AS CHARGE_FLAG, --是否收费
       G.FSSJ AS CHARGE_DTIME, --收费时间
       DECODE(D.PSBJ, 'Y', '1', 'N', '2', '2') AS DRUG_SKIN_FLAG, --皮试判别标识
       DECODE(E.SKIN_TEST,
              '+',
              '阳',
              '-',
              '阴',
              'W',
              '未',
              'M',
              '免',
              'T',
              '脱敏',
              '') AS DRUG_SKIN_RESULT, --皮试结果
       '' AS INSPECTION_PART_CODE, --检查部位代码
       '' AS INSPECTION_PART_NAME, --检查部位名称
       '' AS EMER_FLAG, --加急标志
       '' AS APPLY_NO, --申请单号
       '' AS REPORT_NO, --报告单号
       C.DEMAND AS NOTE, --备注
       '' AS USE_TIMES, -- 使用频率
       D.CDMC AS PRODUCTION_PLACE, --生产产地
       '' AS PRODUCTION_DTIME, --生产日期
       '' AS VALID_DTIME, --有效日期
	   	 B.DM AS MEDIC_CODE, --	中心药品代码--------------------------------------------------上报市平台处理
     NVL(D.YBYPBM,'999')	 AS MEDIC_CODE_SAFETY, --	医保代码
    E.SELF_MARK AS MEDIC_SELF, --	自备  默认N
    E.MED_INS_MARK AS MEDIC_SAFETY, --	医保自负  默认N
       C.RECORD_TIME AS CREATE_DTIME, --业务数据创建时间
       C.RECORD_TIME AS UPDATE_DTIME, --业务数据更新时间
       '' AS RECORD_DTIME, --记录时间
       '' AS RECORD_UPDATE_DTIME, --记录更新时间



/****以下为2022年6月21日处方HIS贯通增加****/

'3'		AS	INFOR_SOURCE	,--	处方来源	S3	AN..2	Y	处方来源代码 NBC01.01.027	20211210新增
DECODE(C.CATEGORY ,'2','1','3','2','7','3','8','3','9','5','10','5','9')	AS	INFOR_IDENTIFICATION_CODE	,--	处方辨识代码	S3	AN..50	Y	处方辨识代码 NBC01.01.026	20211210新增
NVL(ROUND((SELECT TS/NUM FROM HMISW2003.YZYFB WHERE DM = B.YF)*E.TIMES,2),'1')	AS	INFOR_VALID_DATE	,--	处方有效天数	N	N..4	Y	指处方超过多少天就不能核销（用于院内审核发药，外配药店发药）。	20211210新增
(SELECT XM FROM HMISW2003.ZGXX WHERE ID = A.FYRY)	AS	INFOR_REVIEWER_NAME	,--	处方审核药剂师姓名	S1	AN..50	Y		20211210新增
(SELECT XM FROM HMISW2003.ZGXX WHERE ID = A.FYRY)	AS	INFOR_REVIEWER_ID	,--	处方审核药剂师id	S3	N..10		中心人员库 NBD03.00.001	20211210新增 --------------------------------------------------上报市平台处理
A.FYSJ	AS	INFOR_REVIEW_TIME	,--	处方审核时间	D	DT15			20211210新增
A.PYSJ	AS	INFOR_PRESCRIBE_TIME	,--	配药时间	D	DT15			20211210新增
A.FYSJ	AS	INFOR_DISPENSE_TIME	,--	发药时间	D	DT15	Y		20211210新增
'0' 	AS	INFOR_STATUS	,--	处方状态	S3	AN..2	Y	处方状态代码 NBC01.01.025	20211210新增，20220419字典扩增
NULL AS	INFOR_cancel_time	,--	作废时间	D	DT15			20211215新增
(SELECT SUM(JE) FROM HMISW2003.MZCFMXXX WHERE NO = A.NO )	AS	INFOR_PRES_FEE	,--	处方金额	N	N..20	Y	处方计价金额，单位为分	20220419新增
(SELECT XM FROM HMISW2003.ZGXX WHERE ID = A.PYRY)	AS	INFOR_PRESCRIBE_EMP_NAME	,--	处方调配药剂师姓名	S1	AN..50		对门急诊处方进行调配的药剂师签署的在公安户籍管理部门正式登记注册的姓氏和名称	20220419新增
(SELECT XM FROM HMISW2003.ZGXX WHERE ID = A.PYRY)	AS	INFOR_PRESCRIBE_EMP_ID	,--	处方调配药剂师编号	S1	AN..50		中心人员库 NBD03.00.001	20220419新增--------------------------------------------------上报市平台处理
(SELECT XM FROM HMISW2003.ZGXX WHERE ID = A.FYRY)	AS	INFOR_DISPENSE_EMP_NAME	,--	处方发药药剂师姓名	S1	AN..50		按照审核、调配后的门急诊处方，给患者发药的药剂师签署的在公安户籍管理部门正式登记注册的姓氏和名称	20220419新增
(SELECT XM FROM HMISW2003.ZGXX WHERE ID = A.FYRY)	AS	INFOR_DISPENSE_EMP_ID	,--	处方发药药剂师编号	S1	AN..50		中心人员库 NBD03.00.001	20220419新增--------------------------------------------------上报市平台处理
C.DEMAND	AS	INFOR_REMARK	,--	处方备注信息	S1	AN..2000		对处方信息的重要提示和补充说明	20220419新增

NULL	AS	INFOR_CIRCULATE_FLAG	,--	允许流转标志	S2	N1		1. 允许流转 2.不允许流转	20220419新增
A.SFNO	AS	LIST_CHARGE_ID	,--	收费号	N	AN..20	Y	与门诊收费表ORG_CHARGE_ID保持一致
'1'	AS	LIST_IS_MEDI	,--	是否药品	S3	AN..2	Y	是否代码表 NBP00.00.006	20211210新增
DECODE(E.IS_MAIN,'Y','1','2')	AS	LIST_IS_MAIN	,--	是否主药	S3	AN..2	Y	是否代码表 NBP00.00.006，输液处方，溶药为主药	20211210新增
CASE WHEN D.KSSJB>0 THEN '1' ELSE '2' END	AS	LIST_ANTIBIOS_FLAG	,--	抗菌药物标志	S3	AN..2	Y	抗生素级别代码表 NBD06.00.011	20211210新增
CASE WHEN D.YPGLBZ = 'J' AND D.TSYPDJ = '1' THEN '1' WHEN D.YPGLBZ = 'J' AND D.TSYPDJ = '2' THEN '2' WHEN D.YPGLBZ = 'J' AND D.TSYPDJ NOT IN('1','2') THEN '9' ELSE '8' END	AS	LIST_SPIRIT_FLAG	,--	精神药物标志	S3	AN..2		精神药物代码表 NBC01.01.032	20211213新增
DECODE(D.YPGLBZ,'M','1','2')	AS	LIST_ANAESTHETIZTION	,--	麻醉药物标志	S3	AN..2	Y	是否代码表 NBP00.00.006	20211210新增
(SELECT DECODE(JBYW,'Y','1','2') FROM HMISW2003.YPMCQT WHERE YPBH = B.DM) AS	LIST_BASE_FLAG	,--	基本药物标志	S3	AN..2	Y	基药标志代码 NBC01.01.033	20211210新增
CASE WHEN (SELECT YMZLDM FROM HMISW2003.YPMCQT WHERE YPBH = B.DM ) IS NULL THEN '2' ELSE '1' END	AS	LIST_VACCINE_FLAG	,--	疫苗标志	S3	AN..2	Y	是否代码表 NBP00.00.006	20211210新增
DECODE(D.YPGLBZ,'S','1','2')	AS	LIST_INFUSION_FLAG	,--	输液用药标志	S3	AN..2	Y	是否代码表 NBP00.00.006	20211210新增
CASE WHEN B.SL<0 THEN '1' ELSE '2' END	AS	LIST_WITHDRAWAL_FLAG	,--	退药标志	S3	AN..2	Y	是否代码表 NBP00.00.006	20211210新增
(SELECT MC FROM HMISW2003.YPJX WHERE NO = D.JX)	AS	LIST_DOSAGE_FORM	,--	药物剂型代码	S3	AN..3	Y	药物剂型代码 NBC01.01.028	20211210新增	--------------------------------------------------值域转换
D.DW	AS	LIST_SPECIFICATION_UNIT	,--	药品包装规格单位	S1	AN..30	Y	药品包装规格单位，若是药品，必填。发药包装单位，例如：瓶、盒。对于医院自定义的包装，可以提供自定义的包装单位。	20211210新增
D.SL2	AS	LIST_SPECIFICATION_	,--	药品包装规格系数	S1	AN..30	Y	若是药品，必填。例如：12支/每盒中的12 ，是指每盒中有12支。这里的12是指当前包装中有12个药品规格字段中的装量单位“支”的数量。对于医院自定义的包装，请提供自定义的包装中包含的最小装量单位的数量，比如包装中包含有6支，其值就为6。	20211210新增
B.SL	AS	LIST_DISPENSE_NUMBER	,--	发药数量	N	N..8,2	Y		20211210新增
D.DW2	AS	LIST_DISPENSE_UNIT	,--	发药单位	S1	AN..6	Y		20211210新增
D.JLDW	AS	LIST_DOSE_UNITNAME	,--	剂量单位名称	S1	AN..16	Y		20211210新增
D.JLDW	AS	LIST_DOSE_UNITID	,--	剂量单位代码	S3	AN..16	Y	药物剂量单位代码 NBC01.01.029	20211210新增	--------------------------------------------------值域转换
D.DW1	AS	LIST_USEUNIT_ID	,--	用量单位代码	S3	AN..6	Y	药物用量单位代码 NBC01.01.030	20211210新增--------------------------------------------------值域转换
DECODE(D.PSBJ,'Y','1','2')	AS	LIST_IS_SKINTESTDRUG	,--	是否皮试药品	S3	AN..2	Y	是否代码表 NBP00.00.006	20211210新增
'0'	AS	LIST_REVISE_FLAG	,--	修改标志	S3	AN..2	Y	正常作废代码 NBC01.01.031	20211210新增
DECODE(D.YPGLBZ,'D','1','2')	AS	LIST_POISON_FLAG	,--	毒性药物标志	S2	N1		是否代码表 NBP00.00.006	20220419新增
DECODE(D.YPGLBZ,'D','1','2') AS	LIST_POISONMADE_FLAG	,--	易制毒药物标志	S2	N1		是否代码表 NBP00.00.006	20220419新增
NULL	AS	LIST_MEDI_TIMING	,--	给药时机	S1	AN..50		给药时机，如：饭前、饭后、空腹等	20220419新增
B.SL*D.SL1	AS	LIST_DRUGUSE_TOTAL	,--	药物使用总剂量	N	N..10,4		药物使用总剂量	20220419新增
DECODE(B.ZBBZ,'Y','2','1')	AS	LIST_DRUG_SOURCE	,--	药品来源代码	S2	N1		1.医院药品 2.自备药品	20220419新增
NULL	AS	LIST_MEDI_SPEED	,--	给药速度	S1	AN..20		给药速度，静脉输液药品滴注时间和速度的描述，如：1小时、20滴/分钟，需同时传入数字和单位，单位为小时或滴/分钟	20220419新增
NULL	AS	LIST_LIMITED_TIME	,--	限用时间	S1	AN..20		限用时间，静脉输液药品配制后使用时间的描述，如：现配现用、立即使用、2h内使用等	20220419新增
NULL	AS	LIST_MEDI_PURPOSE	,--	药嘱目的	S1	AN..50		药嘱目的，（药嘱开具的目的，科室领药、带手术室等）	20220419新增
B.JE	AS	LIST_PROJECT_AMOUNT	,--	项目金额	N	N..10		项目金额，单位：分	20220419新增
CASE WHEN (SELECT KZLYP FROM HMISW2003.YPMCQT WHERE YPBH = B.DM )>0 THEN '1' ELSE '2' END		AS	LIST_ANTI_TUMOR_DRUG	--	抗肿瘤药物标志	S2	N1	Y	是否代码表 NBP00.00.006	20220516新增



FROM HMISW2003.MZCFXX A ,HMISW2003.MZCFMXXX B LEFT JOIN HMISW2003.YPMC D ON B.DM = D.YPBH
,KTHIS.KTDOC_PRESCRIPTION C,KTHIS.KTDOC_PRESCRIPTION_LIST E,KTHIS.KTDOC_WORK_LOG F, HMISW2003.MZSFXX G
WHERE A.NO = B.NO AND A.KFDM = B.KFDM AND A.LX = B.LX AND A.NO = C.FEE_PRES_ID AND A.SFNO = G.NO AND  G.MZH = F.REGISTER_ID AND F.CLINIC_ID = C.CLINIC_ID AND C.PRES_ID = E.PRES_ID AND B.DM= E.DRUG_ID AND B.ZH =E.GROUPNO
    AND A.NO= ? AND A.KFDM = ? AND A.LX = ? AND A.SFNO = ?
        ]]>
    </sql>
    <sql name="querySingle">
        <![CDATA[
select KFDM,
       LX,
       `NO`,
       SFNO,
       SFNO1,
       FYRY,
       FYRYZH,
       PYRY,
       KSBH,
       YSBH,
       YSZH,
       GHKSBH,
       DYNO,
       CKBH,
       PYZT,
       YPJJ,
       PYSJ,
       FYSJ,
       CFMS,
       MBBH,
       PDAPYZT,
       HJCS,
       ZXCFH,
       YXH
from MZCFXX
        ]]>
    </sql>
</sqls>
