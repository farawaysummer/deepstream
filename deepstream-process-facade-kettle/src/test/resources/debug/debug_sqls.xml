<sqls>
    <sql name="createFeeDetail">
        <![CDATA[
CREATE TABLE R_CLI_FEE_DETAIL (
AUTO_ID VARCHAR,
LP_CLI_FEE VARCHAR,
LK_CLI_FEE VARCHAR,
LK_CLI_SEE VARCHAR,
LK_CLI_INVOICE VARCHAR,
LK_CLI_RECIPE VARCHAR,
LK_MPI_PATIENT VARCHAR,
PATIENT_ID VARCHAR,
OUTP_ID VARCHAR,
OUTP_NO VARCHAR,
RECIPE_NO VARCHAR,
APPLY_NO VARCHAR,
INVOICE_NO VARCHAR,
TRANS_TYPE VARCHAR,
ITEM_CODE VARCHAR,
ITEM_NAME VARCHAR,
FEE_TYPE_CODE VARCHAR,
FEE_TYPE_NAME VARCHAR,
UNIT_PRICE VARCHAR,
QTY VARCHAR,
UNIT VARCHAR,
TOT_COST VARCHAR,
SPEC VARCHAR,
DRUG_FLAG VARCHAR,
FEE_DTIME TIMESTAMP(3),
RECIPE_DOC_DEPTCODE VARCHAR,
RECIPE_DOC_DEPTNAME VARCHAR,
EXEC_DEPTCODE VARCHAR,
EXEC_DEPTNAME VARCHAR,
NOTE VARCHAR,
CREATE_DTIME TIMESTAMP(3),
UPDATE_DTIME TIMESTAMP(3),
RECORD_DTIME TIMESTAMP(3),
RECORD_UPDATE_DTIME TIMESTAMP(3),
ORG_ID VARCHAR,
ORG_NAME VARCHAR,
ITEM_TYPE_CODE VARCHAR,
ITEM_TYPE_NAME VARCHAR,
MEDICAL_TYPE_CODE VARCHAR,
MEDICAL_TYPE_NAME VARCHAR,
OPERATOR_CODE VARCHAR,
OPERATOR_NAME VARCHAR,
ORDER_DOCT_CODE VARCHAR,
ORDER_DOCT_NAME VARCHAR,
ORDER_NO VARCHAR,
MIITEM_LEVEL_CODE VARCHAR,
MIITEM_LEVEL_NAME VARCHAR,
PRIMARY KEY (AUTO_ID) NOT ENFORCED
)
 WITH (
'connector' = 'mysql-cdc',
'table-name' = 'R_CLI_FEE_DETAIL',
'database-name' = '',
'username' = 'reseig',
'password' = 'mu-xPL7C',
'hostname' = '192.168.3.168',
'port' = '3216')
        ]]>
    </sql>

    <sql name="createPatientInfo">
        <![CDATA[
CREATE TABLE R_MPI_PATIENTINFO (
AUTO_ID VARCHAR,
LP_MPI_PATIENT VARCHAR,
PATIENT_ID VARCHAR,
NAME VARCHAR,
SEX_CODE VARCHAR,
SEX_NAME VARCHAR,
BIRTH_DATE TIMESTAMP(3),
PERSON_ID VARCHAR,
OCCUP_CODE VARCHAR,
OCCUP_NAME VARCHAR,
EMAIL VARCHAR,
NATIONALITY_CODE VARCHAR,
NATIONALITY_NAME VARCHAR,
NATION_CODE VARCHAR,
NATION_NAME VARCHAR,
EDUCATION_CODE VARCHAR,
EDUCATION_NAME VARCHAR,
MARRIAGE_CODE VARCHAR,
MARRIAGE_NAME VARCHAR,
BLOOD_TYPE_CODE VARCHAR,
BLOOD_TYPE_NAME VARCHAR,
BLOOD_RH_CODE VARCHAR,
BLOOD_RH_NAME VARCHAR,
PATIENT_BELONG_CODE VARCHAR,
PATIENT_BELONG_NAME VARCHAR,
PLACETYPE_CODE VARCHAR,
PLACETYPE_NAME VARCHAR,
REGISTERED_ADDRESS VARCHAR,
HOME_ADDRESS VARCHAR,
PROVINCE_NAME VARCHAR,
CITY_NAME VARCHAR,
COUNTY_NAME VARCHAR,
PHONE_TEL VARCHAR,
MOBILE_TEL VARCHAR,
POST_CODE VARCHAR,
WORK_UNIT VARCHAR,
WORK_PLACE VARCHAR,
WORK_TEL VARCHAR,
WORK_POSTCODE VARCHAR,
CONTACTS_NAME VARCHAR,
RELATION_CODE VARCHAR,
RELATION_NAME VARCHAR,
CONTACTS_TEL VARCHAR,
CONTACTS_WORK_PLACE VARCHAR,
CONTACTS_HOME_ADDRESS VARCHAR,
ID_TYPE_CODE VARCHAR,
ID_TYPE_NAME VARCHAR,
MEDICAL_TYPE_CODE VARCHAR,
MEDICAL_TYPE_NAME VARCHAR,
MEDICAL_ID VARCHAR,
VAAC_ID VARCHAR,
HEALTH_ID VARCHAR,
OFFICER_ID VARCHAR,
PASSPORT_ID VARCHAR,
OTHER_ID VARCHAR,
OPER_CODE VARCHAR,
OPER_NAME VARCHAR,
SOURCE_SYS VARCHAR,
CREATE_DTIME TIMESTAMP(3),
UPDATE_DTIME TIMESTAMP(3),
RECORD_DTIME TIMESTAMP(3),
RECORD_UPDATE_DTIME TIMESTAMP(3),
ORG_ID VARCHAR,
ORG_NAME VARCHAR,
NATIVE_CODE VARCHAR,
NATIVE_NAME VARCHAR,
NEWBORN_FLAG VARCHAR,
BIRTH_PLACE VARCHAR,
PRIMARY KEY (AUTO_ID) NOT ENFORCED
)
 WITH (
'connector' = 'jdbc',
'url' = 'jdbc:mysql://192.168.3.168:3216/eigdb?useSSL=false&autoReconnect=true',
'table-name' = 'R_MPI_PATIENTINFO',
'username' = 'reseig',
'password' = 'mu-xPL7C',
'driver' = 'com.mysql.cj.jdbc.Driver',
'lookup.cache.max-rows' = '5000',
'lookup.cache.ttl' = '5min')
        ]]>
    </sql>

    <sql name="selectFromFeeDetail">
SELECT A.AUTO_ID || '-1' AS AUTO_ID,
       &apos;&apos; AS BATCH_NUM, --批次号 不填
       &apos;&apos; AS UPLOAD_TIME, --系统上传时间 不填
       A.PATIENT_ID AS LOCAL_ID, --人员在本地域唯一 必填
       &apos;&apos; AS RESULTDESC, --处理结果描述 不填
       &apos;&apos; AS RESULTCODE, --处理结果代码 不填
       A.LP_CLI_FEE AS SERIALNUM_ID, --流水号 不填
       &apos;&apos; AS UNIQUEID, --文档唯一ID 必填
       &apos;&apos; AS PID, --主索引唯一ID 不填
       &apos;&apos; AS BUSINESS_RELATION_ID, --业务关联ID 不填
       &apos;&apos; AS BUSINESS_ACTIVE_TYPE, --业务活动类别 不填
       &apos;&apos; AS BUSINESS_ACTIVE_DES, --业务活动类别描述 不填
       A.OUTP_NO AS BUSINESS_ID, --业务流水号 必填
       &apos;&apos; AS BASIC_ACTIVE_TYPE, --基本活动类别 不填
       &apos;&apos; AS BASIC_ACTIVE_DES, --基本活动类别描述 不填
       A.INVOICE_NO AS BASIC_ACTIVE_ID, --基本活动流水号 必填
       &apos;&apos; AS ORGANIZATION_CODE, --组织机构代码 必填
       &apos;&apos; AS ORGANIZATION_NAME, --组织机构名称 必填
       &apos;&apos; AS DOMAIN_CODE, --域代码 必填
       &apos;&apos; AS DOMAIN_NAME, --域名称 必填
       &apos;&apos; AS VER, --版本号 不填
       &apos;&apos; AS VERDES, --版本描述 不填
       &apos;&apos; AS REGION_IDEN, --地区标识 必填
       &apos;&apos; AS DATA_SECURITY, --数据密级 不填
       &apos;&apos; AS RECORD_IDEN, --记录标识 必填
       &apos;&apos; AS CREATE_DATE, --新建时间 不填
      CURRENT_TIMESTAMP AS UPDATE_DATE, --更新时间 不填
       A.UPDATE_DTIME AS DATAGENERATE_DATE, --业务数据产生时间 必填
       B.PATIENT_ID AS DE01_00_009_00, --健康档案标识符
       B.NAME AS DE02_01_039_00, --姓名 必填
       B.SEX_CODE AS DE02_01_040_00, --性别代码 必填
       B.SEX_NAME AS AP02_01_102_01, --性别 必填
       B.BIRTH_DATE AS DE02_01_005_01, --出生日期 必填
       &apos;&apos; AS DE02_01_032_00, --实足年龄 必填
       A.OUTP_NO AS DE01_00_010_00, --就诊流水号 必填
       A.RECIPE_NO AS AP01_00_022_00, --处方号&#47;申请单号 必填
       A.TRANS_TYPE AS AP07_00_031_00, --交易类别 必填
       A.INVOICE_NO AS AP07_00_016_00, --发票编号 必填
       A.FEE_DTIME AS AP07_00_030_00, --计费时间
       A.RECIPE_DOC_DEPTCODE AS AP08_10_055_01, --计费科室代码
       A.RECIPE_DOC_DEPTNAME AS AP08_10_055_02, --计费科室名称
       A.FEE_DTIME AS AP07_00_026_00, --收费时间&#47;退费时间 必填
       A.FEE_TYPE_CODE AS AP06_00_290_01, --费用项目类别代码 必填
       A.ITEM_CODE AS AP07_00_017_00, --费用明细项目代码 必填
       A.ITEM_NAME AS AP07_00_018_00, --费用明细项目名称 必填
       A.UNIT AS AP07_00_019_00, --费用明细项目单位 必填
       A.UNIT_PRICE AS AP07_00_020_00, --费用明细项目单价 必填
       A.QTY AS AP07_00_021_00, --费用明细项目数量 必填
       A.TOT_COST AS AP07_00_022_00, --费用明细项目金额 必填
       A.AUTO_ID AS DE08_10_052_00, --就诊机构代码 必填
      ''   AS AP08_10_013_04, --就诊机构名称 必填
       A.EXEC_DEPTCODE AS AP08_10_025_01, --收费科室代码 必填
       A.EXEC_DEPTNAME AS DE08_10_026_00 ,--收费科室名称 必填
A.UPDATE_DTIME  AS         RBUSINESS_DATE
  FROM R_CLI_FEE_DETAIL A
  LEFT JOIN R_MPI_PATIENTINFO B ON A.LK_MPI_PATIENT = B.LP_MPI_PATIENT

 WHERE A.UPDATE_DTIME &gt;= '2000-01-01 00:00:00'
   AND A.UPDATE_DTIME &lt; '2023-01-01 00:00:00'
        LIMIT 10
    </sql>

    <sql name="selectFromDTable">
        <![CDATA[
            select * from DTable LIMIT 10
        ]]>
    </sql>

    <sql name="insertIntoInterface">
        <![CDATA[
INSERT INTO DI_ADI_EXPSET_LIST_NEU (BATCH_NUM, UPLOAD_TIME, CREATE_DATE, UPDATE_DATE,
                                    AUTO_ID)
SELECT BATCH_NUM,
       UPLOAD_TIME,
       CREATE_DATE,
       CAST(UPDATE_DATE AS STRING),
       AUTO_ID
FROM DTable
        ]]>
    </sql>

    <sql name="select_from_nb_his">
        <![CDATA[
SELECT BBB.ORG_CODE,
       DP_CONCAT(A.PRES_ID , '-' , A.`NO` , '-' , A.GROUPNO,'-1')  AS AUTO_ID, --序列号
       DP_CONCAT(A.PRES_ID , '-' , A.`NO` , '-' , A.GROUPNO,'-1')  AS LP_CLI_RECIPE, --主键-门诊处方业务
       A.PRES_ID AS LK_CLI_RECIPE, --关联键-门诊处方业务
       C.REGISTER_ID AS LK_CLI_SEE, --关联键-门诊就诊业务
       C.SICK_ID AS LK_MPI_PATIENT, --关联键-患者业务
       C.SICK_ID AS PATIENT_ID, --患者号
       C.REGISTER_ID AS OUTP_ID, --门诊号
       C.REGISTER_ID AS OUTP_NO, --门诊就诊流水号
       DP_CONCAT(A.PRES_ID,'-',B.CATEGORY) AS RECIPE_NO, --处方号
       B.RECORD_TIME AS RECIPE_DTIME, --处方时间
       C.DEPT_ID AS RECIPE_DEPT_CODE, --开立科室代码
       '' AS RECIPE_DEPT_NAME, --开立科室名称
       C.EMP_ID AS RECIPE_DOC_CODE, --开立医生代码
       '' AS RECIPE_DOC_NAME, --开立医生名称
       '1' AS DRUG_FLAG, --药品标识
       A.DRUG_ID AS ITEM_CODE, --项目代码
       D.HZMC AS ITEM_NAME, --项目名称
       '' AS ITEM_TYPE_CODE, --项目类别代码
       '' AS ITEM_TYPE_NAME, --项目类别名称
       D.LSJ AS UNIT_PRICE, --单价
       A.QUANTITY AS QTY, --数量
       D.DW2 AS UNIT, --计价单位
       D.GG AS SPEC, --规格
       B.CATEGORY AS DRUG_RECP_TYPECODE, --处方类型代码
       '' AS DRUG_RECP_TYPENAME, --处方类型名称
       A.USAGE AS DRUG_USE_FREQCODE, --使用频次代码
       '' AS DRUG_USE_FREQNAME, --使用频次名称
       A.DOSE AS DRUG_EACH_DOSE, --药品每次使用剂量
       D.JLDW AS DRUG_DOSE_UNIT, --剂量单位
       A.DRUG_WAY AS DRUG_USAGE_CODE, --药品使用用法代码
       '' AS DRUG_USAGE_NAME, --药品使用用法名称
       D.JX AS DOSAGE_FORM_CODE, --药品剂型代码
       '' AS DOSAGE_FORM_NAME, --药品剂型名称
       A.QUANTITY AS DRUG_TOTAL_DOSE, --药品使用总剂量
       D.DW2 AS DRUG_TOTAL_UNIT, --药品使用总剂量单位
       '' AS DRUG_START_DTIME, --用药开始时间
       '' AS DRUG_END_DTIME, --用药停止时间
       '' AS DURG_SEND_DTIME, --发药时间
       '' AS DRUG_USE_DAYS, --药品使用天数
       '' AS DRUG_PACKAGE_QTY, --药品包装数量
       '' AS DRUG_PACKAGE_UNIT, --药品包装单位
       '' AS DRUG_MIN_UNIT, --最小单位
       '' AS DRUG_BASE_DOSE, --药品基本剂量
       '' AS DRUG_MAIN_FLAG, --主药标志
       DP_CONCAT(A.PRES_ID , '-' , A.`NO` , '-' , A.GROUPNO) AS GROUP_NO, --组合号
       '' AS DRUG_HERB_FOOTNOTES, --草药脚注
       A.TIMES AS HERB_DOSE_QTY, --药品付数
       '' AS CHARGE_FLAG, --是否收费
       '' AS CHARGE_DTIME, --收费时间
       DP_DECODE(D.PSBJ, 'Y', '1', 'N', '2', '2') AS DRUG_SKIN_FLAG, --皮试判别标识
       DP_DECODE(A.SKIN_TEST,
              '+',
              '阳',
              '-',
              '阴',
              'W',
              '未',
              'M',
              '免',
              'T',
              '脱敏',
              '') AS DRUG_SKIN_RESULT, --皮试结果
       '' AS INSPECTION_PART_CODE, --检查部位代码
       '' AS INSPECTION_PART_NAME, --检查部位名称
       '' AS EMER_FLAG, --加急标志
       '' AS APPLY_NO, --申请单号
       '' AS REPORT_NO, --报告单号
       B.DEMAND AS NOTE, --备注
       '' AS USE_TIMES, -- 使用频率
       D.CDMC AS PRODUCTION_PLACE, --生产产地
       '' AS PRODUCTION_DTIME, --生产日期
       '' AS VALID_DTIME, --有效日期
	   	 '' AS MEDIC_CODE, --	中心药品代码
     '' AS MEDIC_CODE_SAFETY, --	医保代码
    A.SELF_MARK AS MEDIC_SELF, --	自备  默认N
    A.MED_INS_MARK AS MEDIC_SAFETY, --	医保自负  默认N
       B.RECORD_TIME AS CREATE_DTIME, --业务数据创建时间
       B.RECORD_TIME AS UPDATE_DTIME, --业务数据更新时间
       '' AS RECORD_DTIME, --记录时间
       '' AS RECORD_UPDATE_DTIME --记录更新时间
  FROM KTDOC_PRESCRIPTION_LIST A
  LEFT JOIN YPMC D
    ON A.DRUG_ID = D.YPBH,KTDOC_PRESCRIPTION B
LEFT JOIN (SELECT ORG_CODE,CLINIC_ID FROM KTHRAEVT_CLINIC GROUP BY ORG_CODE,CLINIC_ID) BBB ON BBB.CLINIC_ID = B.CLINIC_ID
  LEFT JOIN KTDOC_WORK_LOG C
    ON B.CLINIC_ID = C.CLINIC_ID
 WHERE A.PRES_ID = B.PRES_ID
        ]]>
    </sql>

    <sql name="select_from_nb_his_bak">
        <![CDATA[
SELECT BBB.ORG_CODE,
       A.PRES_ID || '-' || A.`NO` || '-' || A.GROUPNO||'-1' AS AUTO_ID, --序列号
       A.PRES_ID || '-' || A.`NO` || '-' || A.GROUPNO||'-1'  AS LP_CLI_RECIPE, --主键-门诊处方业务
       A.PRES_ID AS LK_CLI_RECIPE, --关联键-门诊处方业务
       C.REGISTER_ID AS LK_CLI_SEE, --关联键-门诊就诊业务
       C.SICK_ID AS LK_MPI_PATIENT, --关联键-患者业务
       C.SICK_ID AS PATIENT_ID, --患者号
       C.REGISTER_ID AS OUTP_ID, --门诊号
       C.REGISTER_ID AS OUTP_NO, --门诊就诊流水号
       A.PRES_ID||'-'||B.CATEGORY AS RECIPE_NO, --处方号
       B.RECORD_TIME AS RECIPE_DTIME, --处方时间
       C.DEPT_ID AS RECIPE_DEPT_CODE, --开立科室代码
       '' AS RECIPE_DEPT_NAME, --开立科室名称
       C.EMP_ID AS RECIPE_DOC_CODE, --开立医生代码
       '' AS RECIPE_DOC_NAME, --开立医生名称
       '1' AS DRUG_FLAG, --药品标识
       A.DRUG_ID AS ITEM_CODE, --项目代码
       D.HZMC AS ITEM_NAME, --项目名称
       '' AS ITEM_TYPE_CODE, --项目类别代码
       '' AS ITEM_TYPE_NAME, --项目类别名称
       D.LSJ AS UNIT_PRICE, --单价
       A.QUANTITY AS QTY, --数量
       D.DW2 AS UNIT, --计价单位
       D.GG AS SPEC, --规格
       B.CATEGORY AS DRUG_RECP_TYPECODE, --处方类型代码
       '' AS DRUG_RECP_TYPENAME, --处方类型名称
       A.USAGE AS DRUG_USE_FREQCODE, --使用频次代码
       '' AS DRUG_USE_FREQNAME, --使用频次名称
       A.DOSE AS DRUG_EACH_DOSE, --药品每次使用剂量
       D.JLDW AS DRUG_DOSE_UNIT, --剂量单位
       A.DRUG_WAY AS DRUG_USAGE_CODE, --药品使用用法代码
       '' AS DRUG_USAGE_NAME, --药品使用用法名称
       D.JX AS DOSAGE_FORM_CODE, --药品剂型代码
       '' AS DOSAGE_FORM_NAME, --药品剂型名称
       A.QUANTITY AS DRUG_TOTAL_DOSE, --药品使用总剂量
       D.DW2 AS DRUG_TOTAL_UNIT, --药品使用总剂量单位
       '' AS DRUG_START_DTIME, --用药开始时间
       '' AS DRUG_END_DTIME, --用药停止时间
       '' AS DURG_SEND_DTIME, --发药时间
       '' AS DRUG_USE_DAYS, --药品使用天数
       '' AS DRUG_PACKAGE_QTY, --药品包装数量
       '' AS DRUG_PACKAGE_UNIT, --药品包装单位
       '' AS DRUG_MIN_UNIT, --最小单位
       '' AS DRUG_BASE_DOSE, --药品基本剂量
       '' AS DRUG_MAIN_FLAG, --主药标志
       A.PRES_ID || '-' || A.`NO` || '-' || A.GROUPNO AS GROUP_NO, --组合号
       '' AS DRUG_HERB_FOOTNOTES, --草药脚注
       A.TIMES AS HERB_DOSE_QTY, --药品付数
       '' AS CHARGE_FLAG, --是否收费
       '' AS CHARGE_DTIME, --收费时间
       DP_DECODE(D.PSBJ, 'Y', '1', 'N', '2', '2') AS DRUG_SKIN_FLAG, --皮试判别标识
       DP_DECODE(A.SKIN_TEST,
              '+',
              '阳',
              '-',
              '阴',
              'W',
              '未',
              'M',
              '免',
              'T',
              '脱敏',
              '') AS DRUG_SKIN_RESULT, --皮试结果
       '' AS INSPECTION_PART_CODE, --检查部位代码
       '' AS INSPECTION_PART_NAME, --检查部位名称
       '' AS EMER_FLAG, --加急标志
       '' AS APPLY_NO, --申请单号
       '' AS REPORT_NO, --报告单号
       B.DEMAND AS NOTE, --备注
       '' AS USE_TIMES, -- 使用频率
       D.CDMC AS PRODUCTION_PLACE, --生产产地
       '' AS PRODUCTION_DTIME, --生产日期
       '' AS VALID_DTIME, --有效日期
	   	 '' AS MEDIC_CODE, --	中心药品代码
     '' AS MEDIC_CODE_SAFETY, --	医保代码
    A.SELF_MARK AS MEDIC_SELF, --	自备  默认N
    A.MED_INS_MARK AS MEDIC_SAFETY, --	医保自负  默认N
       B.RECORD_TIME AS CREATE_DTIME, --业务数据创建时间
       B.RECORD_TIME AS UPDATE_DTIME, --业务数据更新时间
       '' AS RECORD_DTIME, --记录时间
       '' AS RECORD_UPDATE_DTIME --记录更新时间
  FROM KTDOC_PRESCRIPTION_LIST A
  LEFT JOIN YPMC D
    ON A.DRUG_ID = D.YPBH,KTDOC_PRESCRIPTION B
LEFT JOIN (SELECT ORG_CODE,CLINIC_ID FROM KTHRAEVT_CLINIC GROUP BY ORG_CODE,CLINIC_ID) BBB ON BBB.CLINIC_ID = B.CLINIC_ID
  LEFT JOIN KTDOC_WORK_LOG C
    ON B.CLINIC_ID = C.CLINIC_ID
 WHERE A.PRES_ID = B.PRES_ID
        ]]>
    </sql>
</sqls>