<?xml version="1.0" encoding="UTF-8"?>
<sqls>
    <sql name="S_CLI_RECIPE"><![CDATA[
CREATE TABLE S_CLI_RECIPE_KAFKA (
`BASE_ID` VARCHAR,
`HOSP_ID` VARCHAR,
`HOSP_NAME` VARCHAR,
`BATCH_NO` VARCHAR,
`PATIENT_ID` VARCHAR,
`OUTP_ID` VARCHAR,
`OUTP_NO` VARCHAR,
`RECIPE_NO` VARCHAR,
`RECIPE_DTIME` VARCHAR,
`RECIPE_DEPT_CODE` VARCHAR,
`RECIPE_DEPT_NAME` VARCHAR,
`RECIPE_DOC_CODE` VARCHAR,
`RECIPE_DOC_NAME` VARCHAR,
`DRUG_FLAG` VARCHAR,
`ITEM_CODE` VARCHAR,
`ITEM_NAME` VARCHAR,
`ITEM_TYPE_CODE` VARCHAR,
`ITEM_TYPE_NAME` VARCHAR,
`UNIT_PRICE` VARCHAR,
`QTY` VARCHAR,
`UNIT` VARCHAR,
`SPEC` VARCHAR,
`DRUG_RECP_TYPECODE` VARCHAR,
`DRUG_RECP_TYPENAME` VARCHAR,
`DRUG_USE_FREQCODE` VARCHAR,
`DRUG_USE_FREQNAME` VARCHAR,
`DRUG_EACH_DOSE` VARCHAR,
`DRUG_DOSE_UNIT` VARCHAR,
`DRUG_USAGE_CODE` VARCHAR,
`DRUG_USAGE_NAME` VARCHAR,
`DOSAGE_FORM_CODE` VARCHAR,
`DOSAGE_FORM_NAME` VARCHAR,
`DRUG_TOTAL_DOSE` VARCHAR,
`DRUG_TOTAL_UNIT` VARCHAR,
`DRUG_START_DTIME` VARCHAR,
`DRUG_END_DTIME` VARCHAR,
`DURG_SEND_DTIME` VARCHAR,
`DRUG_USE_DAYS` VARCHAR,
`DRUG_PACKAGE_QTY` VARCHAR,
`DRUG_PACKAGE_UNIT` VARCHAR,
`DRUG_MIN_UNIT` VARCHAR,
`DRUG_BASE_DOSE` VARCHAR,
`DRUG_MAIN_FLAG` VARCHAR,
`GROUP_NO` VARCHAR,
`DRUG_HERB_FOOTNOTES` VARCHAR,
`HERB_DOSE_QTY` VARCHAR,
`CHARGE_FLAG` VARCHAR,
`CHARGE_DTIME` VARCHAR,
`DRUG_SKIN_FLAG` VARCHAR,
`DRUG_SKIN_RESULT` VARCHAR,
`INSPECTION_PART_CODE` VARCHAR,
`INSPECTION_PART_NAME` VARCHAR,
`EMER_FLAG` VARCHAR,
`APPLY_NO` VARCHAR,
`REPORT_NO` VARCHAR,
`NOTE` VARCHAR,
`USE_TIMES` VARCHAR,
`MEDIC_CODE` VARCHAR,
`MEDIC_CODE_SAFETY` VARCHAR,
`MEDIC_SELF` VARCHAR,
`MEDIC_SAFETY` VARCHAR,
`CREATE_DTIME` VARCHAR,
`UPDATE_DTIME` VARCHAR,
`RECORD_DTIME` VARCHAR,
`RECORD_UPDATE_DTIME` VARCHAR,
`DRUG_INTERFACE_CODE` VARCHAR,
`DRUG_INTERFACE_NAME` VARCHAR,
`OLD_RECIPE_DOC_CODE` VARCHAR,
`IFOR_SOURCE` VARCHAR,
`IFOR_IDETIFICATIO_CODE` VARCHAR,
`IFOR_VALID_DATE` VARCHAR,
`IFOR_REVIEWER_AME` VARCHAR,
`IFOR_REVIEWER_ID` VARCHAR,
`IFOR_REVIEW_TIME` DATE,
`IFOR_PRESCRIBE_TIME` DATE,
`IFOR_DISPESE_TIME` DATE,
`IFOR_STATUS` VARCHAR,
`IFOR_ccel_time` DATE,
`IFOR_PRES_FEE` VARCHAR,
`IFOR_PRESCRIBE_EMP_AME` VARCHAR,
`IFOR_PRESCRIBE_EMP_ID` VARCHAR,
`IFOR_DISPESE_EMP_AME` VARCHAR,
`IFOR_DISPESE_EMP_ID` VARCHAR,
`IFOR_REMARK` VARCHAR,
`IFOR_CIRCULATE_FLAG` VARCHAR,
`LIST_CHARGE_ID` VARCHAR,
`LIST_IS_MEDI` VARCHAR,
`LIST_IS_MAI` VARCHAR,
`LIST_TIBIOS_FLAG` VARCHAR,
`LIST_SPIRIT_FLAG` VARCHAR,
`LIST_AESTHETIZTIO` VARCHAR,
`LIST_BASE_FLAG` VARCHAR,
`LIST_VACCIE_FLAG` VARCHAR,
`LIST_IFUSIO_FLAG` VARCHAR,
`LIST_WITHDRAWAL_FLAG` VARCHAR,
`LIST_DOSAGE_FORM` VARCHAR,
`LIST_SPECIFICATIO_UIT` VARCHAR,
`LIST_SPECIFICATIO_` VARCHAR,
`LIST_DISPESE_UMBER` VARCHAR,
`LIST_DISPESE_UIT` VARCHAR,
`LIST_DOSE_UNITNAME` VARCHAR,
`LIST_DOSE_UNITID` VARCHAR,
`LIST_USEUNIT_ID` VARCHAR,
`LIST_IS_SKINTESTDRUG` VARCHAR,
`LIST_REVISE_FLAG` VARCHAR,
`LIST_POISON_FLAG` VARCHAR,
`LIST_POISONMADE_FLAG` VARCHAR,
`LIST_MEDI_TIMING` VARCHAR,
`LIST_DRUGUSE_TOTAL` VARCHAR,
`LIST_DRUG_SOURCE` VARCHAR,
`LIST_MEDI_SPEED` VARCHAR,
`LIST_LIMITED_TIME` VARCHAR,
`LIST_MEDI_PURPOSE` VARCHAR,
`LIST_PROJECT_AMOUNT` VARCHAR,
`LIST_ANTI_TUMOR_DRUG` VARCHAR,
`AUTO_ID` VARCHAR,
proctime as PROCTIME(),
PRIMARY KEY (`AUTO_ID`) NOT ENFORCED
)
 WITH (
'connector' = 'kafka',
'topic' = 's_cli_recipe',
'properties.bootstrap.servers' = 'localhost:9092',
'properties.group.id' = 'k_default',
'scan.startup.mode' = 'group-offsets',
'format' = 'avro')
]]></sql>
    <sql name="S_CLI_RECIPE_CDC"><![CDATA[
CREATE TABLE S_CLI_RECIPE_CDC (
`BASE_ID` VARCHAR,
`HOSP_ID` VARCHAR,
`HOSP_NAME` VARCHAR,
`BATCH_NO` VARCHAR,
`PATIENT_ID` VARCHAR,
`OUTP_ID` VARCHAR,
`OUTP_NO` VARCHAR,
`RECIPE_NO` VARCHAR,
`RECIPE_DTIME` VARCHAR,
`RECIPE_DEPT_CODE` VARCHAR,
`RECIPE_DEPT_NAME` VARCHAR,
`RECIPE_DOC_CODE` VARCHAR,
`RECIPE_DOC_NAME` VARCHAR,
`DRUG_FLAG` VARCHAR,
`ITEM_CODE` VARCHAR,
`ITEM_NAME` VARCHAR,
`ITEM_TYPE_CODE` VARCHAR,
`ITEM_TYPE_NAME` VARCHAR,
`UNIT_PRICE` VARCHAR,
`QTY` VARCHAR,
`UNIT` VARCHAR,
`SPEC` VARCHAR,
`DRUG_RECP_TYPECODE` VARCHAR,
`DRUG_RECP_TYPENAME` VARCHAR,
`DRUG_USE_FREQCODE` VARCHAR,
`DRUG_USE_FREQNAME` VARCHAR,
`DRUG_EACH_DOSE` VARCHAR,
`DRUG_DOSE_UNIT` VARCHAR,
`DRUG_USAGE_CODE` VARCHAR,
`DRUG_USAGE_NAME` VARCHAR,
`DOSAGE_FORM_CODE` VARCHAR,
`DOSAGE_FORM_NAME` VARCHAR,
`DRUG_TOTAL_DOSE` VARCHAR,
`DRUG_TOTAL_UNIT` VARCHAR,
`DRUG_START_DTIME` VARCHAR,
`DRUG_END_DTIME` VARCHAR,
`DURG_SEND_DTIME` VARCHAR,
`DRUG_USE_DAYS` VARCHAR,
`DRUG_PACKAGE_QTY` VARCHAR,
`DRUG_PACKAGE_UNIT` VARCHAR,
`DRUG_MIN_UNIT` VARCHAR,
`DRUG_BASE_DOSE` VARCHAR,
`DRUG_MAIN_FLAG` VARCHAR,
`GROUP_NO` VARCHAR,
`DRUG_HERB_FOOTNOTES` VARCHAR,
`HERB_DOSE_QTY` VARCHAR,
`CHARGE_FLAG` VARCHAR,
`CHARGE_DTIME` VARCHAR,
`DRUG_SKIN_FLAG` VARCHAR,
`DRUG_SKIN_RESULT` VARCHAR,
`INSPECTION_PART_CODE` VARCHAR,
`INSPECTION_PART_NAME` VARCHAR,
`EMER_FLAG` VARCHAR,
`APPLY_NO` VARCHAR,
`REPORT_NO` VARCHAR,
`NOTE` VARCHAR,
`USE_TIMES` VARCHAR,
`MEDIC_CODE` VARCHAR,
`MEDIC_CODE_SAFETY` VARCHAR,
`MEDIC_SELF` VARCHAR,
`MEDIC_SAFETY` VARCHAR,
`CREATE_DTIME` VARCHAR,
`UPDATE_DTIME` VARCHAR,
`RECORD_DTIME` VARCHAR,
`RECORD_UPDATE_DTIME` VARCHAR,
`DRUG_INTERFACE_CODE` VARCHAR,
`DRUG_INTERFACE_NAME` VARCHAR,
`OLD_RECIPE_DOC_CODE` VARCHAR,
`IFOR_SOURCE` VARCHAR,
`IFOR_IDETIFICATIO_CODE` VARCHAR,
`IFOR_VALID_DATE` VARCHAR,
`IFOR_REVIEWER_AME` VARCHAR,
`IFOR_REVIEWER_ID` VARCHAR,
`IFOR_REVIEW_TIME` DATE,
`IFOR_PRESCRIBE_TIME` DATE,
`IFOR_DISPESE_TIME` DATE,
`IFOR_STATUS` VARCHAR,
`IFOR_ccel_time` DATE,
`IFOR_PRES_FEE` VARCHAR,
`IFOR_PRESCRIBE_EMP_AME` VARCHAR,
`IFOR_PRESCRIBE_EMP_ID` VARCHAR,
`IFOR_DISPESE_EMP_AME` VARCHAR,
`IFOR_DISPESE_EMP_ID` VARCHAR,
`IFOR_REMARK` VARCHAR,
`IFOR_CIRCULATE_FLAG` VARCHAR,
`LIST_CHARGE_ID` VARCHAR,
`LIST_IS_MEDI` VARCHAR,
`LIST_IS_MAI` VARCHAR,
`LIST_TIBIOS_FLAG` VARCHAR,
`LIST_SPIRIT_FLAG` VARCHAR,
`LIST_AESTHETIZTIO` VARCHAR,
`LIST_BASE_FLAG` VARCHAR,
`LIST_VACCIE_FLAG` VARCHAR,
`LIST_IFUSIO_FLAG` VARCHAR,
`LIST_WITHDRAWAL_FLAG` VARCHAR,
`LIST_DOSAGE_FORM` VARCHAR,
`LIST_SPECIFICATIO_UIT` VARCHAR,
`LIST_SPECIFICATIO_` VARCHAR,
`LIST_DISPESE_UMBER` VARCHAR,
`LIST_DISPESE_UIT` VARCHAR,
`LIST_DOSE_UNITNAME` VARCHAR,
`LIST_DOSE_UNITID` VARCHAR,
`LIST_USEUNIT_ID` VARCHAR,
`LIST_IS_SKINTESTDRUG` VARCHAR,
`LIST_REVISE_FLAG` VARCHAR,
`LIST_POISON_FLAG` VARCHAR,
`LIST_POISONMADE_FLAG` VARCHAR,
`LIST_MEDI_TIMING` VARCHAR,
`LIST_DRUGUSE_TOTAL` VARCHAR,
`LIST_DRUG_SOURCE` VARCHAR,
`LIST_MEDI_SPEED` VARCHAR,
`LIST_LIMITED_TIME` VARCHAR,
`LIST_MEDI_PURPOSE` VARCHAR,
`LIST_PROJECT_AMOUNT` VARCHAR,
`LIST_ANTI_TUMOR_DRUG` VARCHAR,
`AUTO_ID` VARCHAR,
`isUpload` INT,
`isValidate` INT,
`rbusiness_date` TIMESTAMP(3),
PRIMARY KEY (`AUTO_ID`) NOT ENFORCED
)
 WITH (
'connector' = 'jdbc',
'url' = 'jdbc:mysql://localhost:3306/ods?useSSL=false&autoReconnect=true',
'table-name' = 'S_CLI_RECIPE',
'username' = 'ruisoft',
'password' = 'Ruisoft@123',
'driver' = 'com.mysql.jdbc.Driver')
]]></sql>

    <sql name="createC01">
        <![CDATA[
CREATE TABLE C01040000 (
`PRE_INFOR.ORG_CODE` STRING,
`PRE_INFOR.PRES_ID` STRING,
`PRE_INFOR.CLINIC_ID` STRING,
`PRE_INFOR.RECORD_TIME` DATE,
`PRE_INFOR.TYPE` STRING,
`PRE_INFOR.EMP_ID` STRING,
`PRE_INFOR.CATEGORY` STRING,
`PRE_INFOR.EMP_ID_ORG` STRING,
`PRE_INFOR.CHARGE_ID` STRING,
`PRE_INFOR.FEE_PRES_ID` STRING,
`PRE_INFOR.SOURCE` STRING,
`PRE_INFOR.IDENTIFICATION_CODE` STRING,
`PRE_INFOR.VALID_DATE` STRING,
`PRE_INFOR.REVIEWER_NAME` STRING,
`PRE_INFOR.REVIEWER_ID` STRING,
`PRE_INFOR.REVIEW_TIME` DATE,
`PRE_INFOR.PRESCRIBE_TIME` DATE,
`PRE_INFOR.DISPENSE_TIME` DATE,
`PRE_INFOR.STATUS` STRING,
`PRE_INFOR.cancel_time` DATE,
`PRE_INFOR.PRES_FEE` STRING,
`PRE_INFOR.PRESCRIBE_EMP_NAME` STRING,
`PRE_INFOR.PRESCRIBE_EMP_ID` STRING,
`PRE_INFOR.DISPENSE_EMP_NAME` STRING,
`PRE_INFOR.DISPENSE_EMP_ID` STRING,
`PRE_INFOR.REMARK` STRING,
`PRE_INFOR.CIRCULATE_FLAG` STRING,
`PRE_LIST.ORG_CODE` STRING,
`PRE_LIST.PRES_ID` STRING,
`PRE_LIST.NO` STRING,
`PRE_LIST.GROUPNO` STRING,
`PRE_LIST.MEDIC_CLASS` STRING,
`PRE_LIST.MEDIC_CODE` STRING,
`PRE_LIST.MEDIC_CODE_SAFETY` STRING,
`PRE_LIST.MEDIC_CODE_LOCAL` STRING,
`PRE_LIST.MEDIC_GENERAL_NAME` STRING,
`PRE_LIST.MEDIC_NAME` STRING,
`PRE_LIST.MEDIC_TYPE` STRING,
`PRE_LIST.MEDIC_SPEC` STRING,
`PRE_LIST.MEDIC_AREA` STRING,
`PRE_LIST.MEDIC_USEQUANTITY` STRING,
`PRE_LIST.MEDIC_USEUNIT` STRING,
`PRE_LIST.MEDIC_USEDOSAGE` STRING,
`PRE_LIST.MEDIC_USECODE` STRING,
`PRE_LIST.MEDIC_USEPLAN` STRING,
`PRE_LIST.MEDIC_USEMODE` STRING,
`PRE_LIST.MEDIC_DAYS` STRING,
`PRE_LIST.MEDIC_QUANTITY` STRING,
`PRE_LIST.MEDIC_UNIT` STRING,
`PRE_LIST.MEDIC_SELF` STRING,
`PRE_LIST.MEDIC_SAFETY` STRING,
`PRE_LIST.MEDIC_SAFETYCLASS` STRING,
`PRE_LIST.CREATE_TIME` DATE,
`PRE_LIST.MODIFY_TIME` DATE,
`PRE_LIST.MEDIC_REMARK` STRING,
`PRE_LIST.YPID` STRING,
`PRE_LIST.DDD` STRING,
`PRE_LIST.MEDI_ANTIBIOTIC_FLAG` STRING,
`PRE_LIST.MEDI_BASE` STRING,
`PRE_LIST.FREQUENCY_REMARK` STRING,
`PRE_LIST.DRUG_BATCH_NO` STRING,
`PRE_LIST.PERFORMED_PHARMACY_CODE` STRING,
`PRE_LIST.PACKAGE_QUANTITY` STRING,
`PRE_LIST.PACKAGE_QUANTITY_UNIT` STRING,
`PRE_LIST.HERBAL_DOSES` STRING,
`PRE_LIST.PREPARATION_TECHNIQUE` STRING,
`PRE_LIST.TCM_RECIPE_SEQUENCE` STRING,
`PRE_LIST.DECOCTING_METHOD` STRING,
`PRE_LIST.DOCTOR_PRIV_OF_ANTIBIOS` STRING,
`PRE_LIST.REVIEWER` STRING,
`PRE_LIST.REVIEWER_ID` STRING,
`PRE_LIST.CHARGE_ID` STRING,
`PRE_LIST.IS_MEDI` STRING,
`PRE_LIST.IS_MAIN` STRING,
`PRE_LIST.ANTIBIOS_FLAG` STRING,
`PRE_LIST.SPIRIT_FLAG` STRING,
`PRE_LIST.ANAESTHETIZTION` STRING,
`PRE_LIST.BASE_FLAG` STRING,
`PRE_LIST.VACCINE_FLAG` STRING,
`PRE_LIST.INFUSION_FLAG` STRING,
`PRE_LIST.WITHDRAWAL_FLAG` STRING,
`PRE_LIST.DOSAGE_FORM` STRING,
`PRE_LIST.SPECIFICATION_UNIT` STRING,
`PRE_LIST.SPECIFICATION_` STRING,
`PRE_LIST.DISPENSE_NUMBER` STRING,
`PRE_LIST.DISPENSE_UNIT` STRING,
`PRE_LIST.DOSE_UNITNAME` STRING,
`PRE_LIST.DOSE_UNITID` STRING,
`PRE_LIST.USEUNIT_ID` STRING,
`PRE_LIST.IS_SKINTESTDRUG` STRING,
`PRE_LIST.REVISE_FLAG` STRING,
`PRE_LIST.POISON_FLAG` STRING,
`PRE_LIST.POISONMADE_FLAG` STRING,
`PRE_LIST.MEDI_TIMING` STRING,
`PRE_LIST.DRUGUSE_TOTAL` STRING,
`PRE_LIST.DRUG_SOURCE` STRING,
`PRE_LIST.MEDI_SPEED` STRING,
`PRE_LIST.LIMITED_TIME` STRING,
`PRE_LIST.MEDI_PURPOSE` STRING,
`PRE_LIST.PROJECT_AMOUNT` STRING,
`PRE_LIST.ANTI_TUMOR_DRUG` STRING,
`AUTO_ID` VARCHAR,
`isUpLoad` VARCHAR,
`isValidate` VARCHAR,
`RBUSINESS_DATE` TIMESTAMP(3),
`LKFIELD` VARCHAR,
PRIMARY KEY (`AUTO_ID`) NOT ENFORCED
)
 WITH (
'connector' = 'jdbc',
'url' = 'jdbc:mysql://192.168.3.168:3216/test?useSSL=false&autoReconnect=true',
'table-name' = 'C01.04.00.00',
'username' = 'reseig',
'password' = 'mu-xPL7C',
'driver' = 'com.mysql.cj.jdbc.Driver',
'lookup.cache.max-rows' = '5000',
'lookup.cache.ttl' = '5min')
        ]]>
    </sql>
    <sql name="insertCDC">
        <![CDATA[
INSERT INTO S_CLI_RECIPE_CDC (`BASE_ID`,`HOSP_ID`,`HOSP_NAME`,`BATCH_NO`,`AUTO_ID`,`PATIENT_ID`,`OUTP_ID`,`OUTP_NO`,`RECIPE_NO`,`RECIPE_DTIME`,`RECIPE_DEPT_CODE`,`RECIPE_DEPT_NAME`,`RECIPE_DOC_CODE`,`RECIPE_DOC_NAME`,`DRUG_FLAG`,`ITEM_CODE`,`ITEM_NAME`,`ITEM_TYPE_CODE`,`ITEM_TYPE_NAME`,`UNIT_PRICE`,`QTY`,`UNIT`,`SPEC`,`DRUG_RECP_TYPECODE`,`DRUG_RECP_TYPENAME`,`DRUG_USE_FREQCODE`,`DRUG_USE_FREQNAME`,`DRUG_EACH_DOSE`,`DRUG_DOSE_UNIT`,`DRUG_USAGE_CODE`,`DRUG_USAGE_NAME`,`DOSAGE_FORM_CODE`,`DOSAGE_FORM_NAME`,`DRUG_TOTAL_DOSE`,`DRUG_TOTAL_UNIT`,`DRUG_START_DTIME`,`DRUG_END_DTIME`,`DURG_SEND_DTIME`,`DRUG_USE_DAYS`,`DRUG_PACKAGE_QTY`,`DRUG_PACKAGE_UNIT`,`DRUG_MIN_UNIT`,`DRUG_BASE_DOSE`,`DRUG_MAIN_FLAG`,`GROUP_NO`,`DRUG_HERB_FOOTNOTES`,`HERB_DOSE_QTY`,`CHARGE_FLAG`,`CHARGE_DTIME`,`DRUG_SKIN_FLAG`,`DRUG_SKIN_RESULT`,`INSPECTION_PART_CODE`,`INSPECTION_PART_NAME`,`EMER_FLAG`,`APPLY_NO`,`REPORT_NO`,`NOTE`,`USE_TIMES`,`CREATE_DTIME`,`UPDATE_DTIME`,`RECORD_DTIME`,`RECORD_UPDATE_DTIME`,`ITEM_TYPE_NAME_RAW`,`MEDIC_SAFETY_NAME_RAW`,`DRUG_USAGE_NAME_RAW`,`RECIPE_DEPT_NAME_RAW`,`DOSAGE_FORM_NAME_RAW`,`INSPECTION_PART_NAME_RAW`,`ITEM_TYPE_CODE_RAW`,`DRUG_USE_FREQCODE_RAW`,`MEDIC_SELF_RAW`,`MEDIC_SAFETY_CODE_RAW`,`DRUG_USAGE_CODE_RAW`,`DRUG_SKIN_FLAG_RAW`,`RECIPE_DEPT_CODE_RAW`,`HOSP_ID_RAW`,`DOSAGE_FORM_CODE_RAW`,`INSPECTION_PART_CODE_RAW`,`EMER_FLAG_RAW`,`CHARGE_FLAG_RAW`,`DRUG_MAIN_FLAG_RAW`,`DRUG_FLAG_RAW`,`MEDIC_CODE`,`MEDIC_CODE_SAFETY`,`MEDIC_SELF`,`MEDIC_SAFETY`,`DRUG_INTERFACE_CODE`,`DRUG_INTERFACE_NAME`,`HOSP_ID_BAK`,`HOSP_NAME_BAK`,`OLD_RECIPE_DOC_CODE`,`IFOR_SOURCE`,`IFOR_IDETIFICATIO_CODE`,`IFOR_VALID_DATE`,`IFOR_REVIEWER_AME`,`IFOR_REVIEWER_ID`,`IFOR_REVIEW_TIME`,`IFOR_PRESCRIBE_TIME`,`IFOR_DISPESE_TIME`,`IFOR_STATUS`,`IFOR_CCEL_TIME`,`IFOR_PRES_FEE`,`IFOR_PRESCRIBE_EMP_AME`,`IFOR_PRESCRIBE_EMP_ID`,`IFOR_DISPESE_EMP_AME`,`IFOR_DISPESE_EMP_ID`,`IFOR_REMARK`,`IFOR_CIRCULATE_FLAG`,`LIST_CHARGE_ID`,`LIST_IS_MEDI`,`LIST_IS_MAI`,`LIST_TIBIOS_FLAG`,`LIST_SPIRIT_FLAG`,`LIST_AESTHETIZTIO`,`LIST_BASE_FLAG`,`LIST_VACCIE_FLAG`,`LIST_IFUSIO_FLAG`,`LIST_WITHDRAWAL_FLAG`,`LIST_DOSAGE_FORM`,`LIST_SPECIFICATIO_UIT`,`LIST_SPECIFICATIO_`,`LIST_DISPESE_UMBER`,`LIST_DISPESE_UIT`,`LIST_DOSE_UITAME`,`LIST_DOSE_UITID`,`LIST_USEUIT_ID`,`LIST_IS_SKITESTDRUG`,`LIST_REVISE_FLAG`,`LIST_POISO_FLAG`,`LIST_POISOMADE_FLAG`,`LIST_MEDI_TIMIG`,`LIST_DRUGUSE_TOTAL`,`LIST_DRUG_SOURCE`,`LIST_MEDI_SPEED`,`LIST_LIMITED_TIME`,`LIST_MEDI_PURPOSE`,`LIST_PROJECT_AMOUT`,`LIST_TI_TUMOR_DRUG`)
 SELECT `BASE_ID`,
`HOSP_ID`,
`HOSP_NAME`,
`BATCH_NO`,
`AUTO_ID`,
`PATIENT_ID`,
`OUTP_ID`,
`OUTP_NO`,
`RECIPE_NO`,
`RECIPE_DTIME`,
`RECIPE_DEPT_CODE`,
`RECIPE_DEPT_NAME`,
`RECIPE_DOC_CODE`,
`RECIPE_DOC_NAME`,
`DRUG_FLAG`,
`ITEM_CODE`,
`ITEM_NAME`,
`ITEM_TYPE_CODE`,
`ITEM_TYPE_NAME`,
`UNIT_PRICE`,
`QTY`,
`UNIT`,
`SPEC`,
`DRUG_RECP_TYPECODE`,
`DRUG_RECP_TYPENAME`,
`DRUG_USE_FREQCODE`,
`DRUG_USE_FREQNAME`,
`DRUG_EACH_DOSE`,
`DRUG_DOSE_UNIT`,
`DRUG_USAGE_CODE`,
`DRUG_USAGE_NAME`,
`DOSAGE_FORM_CODE`,
`DOSAGE_FORM_NAME`,
`DRUG_TOTAL_DOSE`,
`DRUG_TOTAL_UNIT`,
`DRUG_START_DTIME`,
`DRUG_END_DTIME`,
`DURG_SEND_DTIME`,
`DRUG_USE_DAYS`,
`DRUG_PACKAGE_QTY`,
`DRUG_PACKAGE_UNIT`,
`DRUG_MIN_UNIT`,
`DRUG_BASE_DOSE`,
`DRUG_MAIN_FLAG`,
`GROUP_NO`,
`DRUG_HERB_FOOTNOTES`,
`HERB_DOSE_QTY`,
`CHARGE_FLAG`,
`CHARGE_DTIME`,
`DRUG_SKIN_FLAG`,
`DRUG_SKIN_RESULT`,
`INSPECTION_PART_CODE`,
`INSPECTION_PART_NAME`,
`EMER_FLAG`,
`APPLY_NO`,
`REPORT_NO`,
`NOTE`,
`USE_TIMES`,
`CREATE_DTIME`,
`UPDATE_DTIME`,
`RECORD_DTIME`,
`RECORD_UPDATE_DTIME`,
`ITEM_TYPE_NAME_RAW`,
`MEDIC_SAFETY_NAME_RAW`,
`DRUG_USAGE_NAME_RAW`,
`RECIPE_DEPT_NAME_RAW`,
`DOSAGE_FORM_NAME_RAW`,
`INSPECTION_PART_NAME_RAW`,
`ITEM_TYPE_CODE_RAW`,
`DRUG_USE_FREQCODE_RAW`,
`MEDIC_SELF_RAW`,
`MEDIC_SAFETY_CODE_RAW`,
`DRUG_USAGE_CODE_RAW`,
`DRUG_SKIN_FLAG_RAW`,
`RECIPE_DEPT_CODE_RAW`,
`HOSP_ID_RAW`,
`DOSAGE_FORM_CODE_RAW`,
`INSPECTION_PART_CODE_RAW`,
`EMER_FLAG_RAW`,
`CHARGE_FLAG_RAW`,
`DRUG_MAIN_FLAG_RAW`,
`DRUG_FLAG_RAW`,
`MEDIC_CODE`,
`MEDIC_CODE_SAFETY`,
`MEDIC_SELF`,
`MEDIC_SAFETY`,
`DRUG_INTERFACE_CODE`,
`DRUG_INTERFACE_NAME`,
`HOSP_ID_BAK`,
`HOSP_NAME_BAK`,
`OLD_RECIPE_DOC_CODE`,
`IFOR_SOURCE`,
`IFOR_IDETIFICATIO_CODE`,
`IFOR_VALID_DATE`,
`IFOR_REVIEWER_AME`,
`IFOR_REVIEWER_ID`,
`IFOR_REVIEW_TIME`,
`IFOR_PRESCRIBE_TIME`,
`IFOR_DISPESE_TIME`,
`IFOR_STATUS`,
`IFOR_CCEL_TIME`,
`IFOR_PRES_FEE`,
`IFOR_PRESCRIBE_EMP_AME`,
`IFOR_PRESCRIBE_EMP_ID`,
`IFOR_DISPESE_EMP_AME`,
`IFOR_DISPESE_EMP_ID`,
`IFOR_REMARK`,
`IFOR_CIRCULATE_FLAG`,
`LIST_CHARGE_ID`,
`LIST_IS_MEDI`,
`LIST_IS_MAI`,
`LIST_TIBIOS_FLAG`,
`LIST_SPIRIT_FLAG`,
`LIST_AESTHETIZTIO`,
`LIST_BASE_FLAG`,
`LIST_VACCIE_FLAG`,
`LIST_IFUSIO_FLAG`,
`LIST_WITHDRAWAL_FLAG`,
`LIST_DOSAGE_FORM`,
`LIST_SPECIFICATIO_UIT`,
`LIST_SPECIFICATIO_`,
`LIST_DISPESE_UMBER`,
`LIST_DISPESE_UIT`,
`LIST_DOSE_UITAME`,
`LIST_DOSE_UITID`,
`LIST_USEUIT_ID`,
`LIST_IS_SKITESTDRUG`,
`LIST_REVISE_FLAG`,
`LIST_POISO_FLAG`,
`LIST_POISOMADE_FLAG`,
`LIST_MEDI_TIMIG`,
`LIST_DRUGUSE_TOTAL`,
`LIST_DRUG_SOURCE`,
`LIST_MEDI_SPEED`,
`LIST_LIMITED_TIME`,
`LIST_MEDI_PURPOSE`,
`LIST_PROJECT_AMOUT`,
`LIST_TI_TUMOR_DRUG` FROM DTable
        ]]>
    </sql>
    <sql name="selectDC">
        <![CDATA[
SELECT
--  INFOR
SUBSTR (A.HOSP_ID,1,8) AS "PRE_INFOR.ORG_CODE",--  医疗机构代码
DECODE((sign(8-length(B.HOSP_ID))),0,'C00',('C'||substr(B.HOSP_ID,-2)))||A.RECIPE_NO||A.ITEM_TYPE_CODE||'00'  AS "PRE_INFOR.PRES_ID",--  处方编号
case when length(B.HOSP_ID)='8' then '00'||''||B.OUTP_NO  else substr(B.HOSP_ID,-2)||''||replace(B.OUTP_ID,'-','')  end  AS "PRE_INFOR.CLINIC_ID",--  接诊编号
A.RECIPE_DTIME AS "PRE_INFOR.RECORD_TIME",--  记录日期
NVL(REPLACE(A.ITEM_TYPE_CODE,'Q',''),(SELECT DECODE(DRUG_TYPE_NAME,'西药','Y','中药','C','成药','Z','免煎','M','其他','Q','膏方','G','Q') FROM S_BASE_DRUG WHERE HOSP_ID = SUBSTR(A.HOSP_ID,0,8) AND DRUG_CODE = A.ITEM_CODE AND ROWNUM  = 1)) AS "PRE_INFOR.TYPE",--  处方类型
NVL((SELECT B.EMPID FROM "d03.00.00.00"   B    WHERE SUBSTR (A.HOSP_ID,1,8)=B.HOSP_ID  AND  B.DOCT_CODE=A.RECIPE_DOC_CODE
AND B.SOURCE_SYS='DEFAULT' AND ROWNUM=1),(SELECT B.EMPID FROM "d03.00.00.00"   B    WHERE SUBSTR (A.HOSP_ID,1,8)=B.HOSP_ID  AND  B.DOCT_CODE=A.RECIPE_DOC_NAME
AND B.SOURCE_SYS='DEFAULT' AND ROWNUM=1))  AS "PRE_INFOR.EMP_ID",--  医生编号
A.DRUG_RECP_TYPENAME AS "PRE_INFOR.CATEGORY",--  处方分类
A.OLD_RECIPE_DOC_CODE AS "PRE_INFOR.EMP_ID_ORG",--  医生本地编号
A.LIST_CHARGE_ID	AS	"PRE_INFOR.CHARGE_ID"	,-- 	收费号	S1	AN..20	Y	与门诊收费表ORG_CHARGE_ID保持一致


/*******扩展***/
A.IFOR_FEE_PRES_ID	AS	"PRE_INFOR.FEE_PRES_ID"	,-- 	收费明细表处方号	S1	AN..22	Y	要求与收费明细表中处方号PRES_ID一致
/*******扩展***/

A.IFOR_SOURCE	AS	"IFOR.SOURCE"	,--  	处方来源	S3	AN..2	Y	处方来源代码 NBC01.01.027	20211210新增
A.IFOR_IDENTIFICATION_CODE	AS	"IFOR.IDENTIFICATION_CODE"	,-- 处方辨识代码	S3	AN..50	Y	处方辨识代码 NBC01.01.026	20211210新增
A.IFOR_VALID_DATE	AS	"IFOR.VALID_DATE"	,-- 	处方有效天数 	N	N..4	Y	指处方超过多少天就不能核销（用于院内审核发药，外配药店发药）。	20211210新增
A.IFOR_REVIEWER_NAME	AS	"IFOR.REVIEWER_NAME"	,-- 	处方审核药剂师姓名	S1	AN..50	Y		20211210新增
(SELECT  F.EMPID  FROM "d03.00.00.00"   F    WHERE A.HOSP_ID =F.HOSP_ID  AND  F.DOCT_NAME=A.IFOR_REVIEWER_ID AND F.SOURCE_SYS='DEFAULT' AND ROWNUM=1) 	AS	"IFOR.REVIEWER_ID"	,-- 	处方审核药剂师ID	S3	N..10		中心人员库 NBD03.00.001	20211210新增	--------------------------------------------------上报市平台处理
A.IFOR_REVIEW_TIME	AS	"IFOR.REVIEW_TIME"	,-- 	处方审核时间	D	DT15			20211210新增
A.IFOR_PRESCRIBE_TIME	AS	"IFOR.PRESCRIBE_TIME"	,-- 	配药时间	D	DT15			20211210新增
A.IFOR_DISPENSE_TIME	AS	"IFOR.DISPENSE_TIME"	,-- 	发药时间	D	DT15	Y		20211210新增
A.IFOR_STATUS	AS	"IFOR.STATUS"	,-- 	S3	AN..2	Y	处方状态代码 NBC01.01.025	20211210新增，20220419字典扩增
A.IFOR_CANCEL_TIME	AS	"IFOR.CANCEL_TIME"	,-- 	作废时间	D	DT15			20211215新增
A.IFOR_PRES_FEE	AS	"IFOR.PRES_FEE"	,-- 	处方金额	N	N..20	Y	处方计价金额，单位为分	20220419新增
A.IFOR_PRESCRIBE_EMP_NAME	AS	"IFOR.PRESCRIBE_EMP_NAME"	,-- 	处方调配药剂师姓名	S1	AN..50		对门急诊处方进行调配的药剂师签署的在公安户籍管理部门正式登记注册的姓氏和名称	20220419新增
(SELECT  F.EMPID  FROM "d03.00.00.00"   F    WHERE A.HOSP_ID =F.HOSP_ID  AND  F.DOCT_NAME=A.IFOR_PRESCRIBE_EMP_ID AND F.SOURCE_SYS='DEFAULT' AND ROWNUM=1)	 AS "IFOR.PRESCRIBE_EMP_ID"	,-- 	处方调配药剂师编号	S1	AN..50		中心人员库 NBD03.00.001	20220419新增	--------------------------------------------------上报市平台处理
A.IFOR_DISPENSE_EMP_NAME	AS	"IFOR.DISPENSE_EMP_NAME"	,-- 	处方发药药剂师姓名	S1	AN..50		按照审核、调配后的门急诊处方，给患者发药的药剂师签署的在公安户籍管理部门正式登记注册的姓氏和名称	20220419新增
(SELECT  F.EMPID  FROM "d03.00.00.00"   F    WHERE A.HOSP_ID =F.HOSP_ID  AND  F.DOCT_NAME=A.IFOR_DISPENSE_EMP_ID AND F.SOURCE_SYS='DEFAULT' AND ROWNUM=1)AS "IFOR.DISPENSE_EMP_ID"	,-- 	处方发药药剂师编号	S1	AN..50		中心人员库 NBD03.00.001	20220419新增	--------------------------------------------------上报市平台处理
A.IFOR_REMARK	AS	"IFOR.REMARK"	,-- 	处方备注信息	S1	AN..2000		对处方信息的重要提示和补充说明	20220419新增
A.IFOR_CIRCULATE_FLAG	AS	"IFOR.CIRCULATE_FLAG"	,-- 	允许流转标志	S2	N1		1.? 允许流转 2.不允许流转 互联网处方、外配处方等患者需要去药店配的处方是允许流转的	20220419新增


--  LIST
SUBSTR (A.HOSP_ID,1,8) AS "PRE_LIST.ORG_CODE",--  医疗机构代码
DECODE((sign(8-length(B.HOSP_ID))),0,'C00',('C'||substr(B.HOSP_ID,-2)))||A.RECIPE_NO||A.ITEM_TYPE_CODE||'00' AS "PRE_LIST.PRES_ID",--  处方编号
replace (substr(A.GROUP_NO,instr(A.GROUP_NO,'-',+1)+1,2),'-','')	AS "PRE_LIST.NO",--  处方序号
substr(A.GROUP_NO,instr(A.GROUP_NO,'-',-1)+1)	AS "PRE_LIST.GROUPNO",--  组号
NVL(REPLACE(A.ITEM_TYPE_CODE,'Q',''),(SELECT DECODE(DRUG_TYPE_NAME,'西药','Y','中药','C','成药','Z','免煎','M','其他','Q','膏方','G','Q') FROM S_BASE_DRUG WHERE HOSP_ID = SUBSTR(A.HOSP_ID,0,8) AND DRUG_CODE = A.ITEM_CODE AND ROWNUM  = 1))   AS "PRE_LIST.MEDIC_CLASS",--  药品分类
(SELECT B.STA_ITEM_CODE FROM S_BASE_DRUG B  WHERE  SUBSTR (A.HOSP_ID,1,8)=B.HOSP_ID AND A.ITEM_CODE=B.DRUG_CODE   AND ROWNUM=1) AS "PRE_LIST.MEDIC_CODE",--  中心药品代码
A.MEDIC_CODE_SAFETY AS "PRE_LIST.MEDIC_CODE_SAFETY",--  医保代码
NULL AS "PRE_LIST.MEDIC_CODE_LOCAL",--  药品本地代码
(SELECT B.STA_ITEM_NAME FROM S_BASE_DRUG B  WHERE SUBSTR (A.HOSP_ID,1,8)=B.HOSP_ID AND A.ITEM_CODE=B.DRUG_CODE AND ROWNUM=1)  AS "PRE_LIST.MEDIC_GENERAL_NAME",--  药品通用名称
(SELECT B.STA_ITEM_NAME FROM S_BASE_DRUG B  WHERE SUBSTR (A.HOSP_ID,1,8)=B.HOSP_ID AND A.ITEM_CODE=B.DRUG_CODE AND ROWNUM=1)  AS "PRE_LIST.MEDIC_NAME",--  药品名称
A.DOSAGE_FORM_CODE AS "PRE_LIST.MEDIC_TYPE",--  药物剂型
A.SPEC AS "PRE_LIST.MEDIC_SPEC",--  药品规格
CASE WHEN A.DRUG_FLAG = '1' THEN NVL((SELECT F.DRUG_PLACE_ORIGIN FROM S_BASE_DRUG  F  WHERE  SUBSTR (A.HOSP_ID,1,8)=F.HOSP_ID AND F.DRUG_CODE=A.ITEM_CODE AND ROWNUM=1),'无') ELSE '无' END  AS "PRE_LIST.MEDIC_AREA",--  药品产地
NVL(A.DRUG_EACH_DOSE,'1')    AS "PRE_LIST.MEDIC_USEQUANTITY",-- 每次用量
NVL(A.DRUG_DOSE_UNIT,'-') AS "PRE_LIST.MEDIC_USEUNIT",-- 用量单位
NVL(A.DRUG_EACH_DOSE,'1') AS "PRE_LIST.MEDIC_USEDOSAGE",-- 每次剂量
A.DRUG_USE_FREQCODE AS "PRE_LIST.MEDIC_USECODE",-- 药物用法编码
A.DRUG_USE_FREQNAME  AS "PRE_LIST.MEDIC_USEPLAN",-- 药物用法
NVL(A.DRUG_USAGE_CODE,'qt') AS "PRE_LIST.MEDIC_USEMODE",-- 给药方式
NVL(A.DRUG_USE_DAYS,'1')  AS "PRE_LIST.MEDIC_DAYS",-- 配药天数
A.QTY AS "PRE_LIST.MEDIC_QUANTITY",-- 配药数量
A.UNIT AS "PRE_LIST.MEDIC_UNIT",-- 配药单位
A.MEDIC_SELF AS "PRE_LIST.MEDIC_SELF",-- 自备
A.MEDIC_SAFETY AS "PRE_LIST.MEDIC_SAFETY",-- 医保自负
NVL(CASE WHEN A.DRUG_FLAG = '1' THEN (SELECT DRUG_MEDI_CODE FROM S_BASE_DRUG  F  WHERE  F.HOSP_ID=SUBSTR(A.HOSP_ID,1,8) AND F.DRUG_CODE=A.ITEM_CODE AND F.SOURCE_SYS = 'DEFAULT'  AND ROWNUM=1) WHEN A.DRUG_FLAG = '2' THEN (SELECT ITEM_OTHER_CODE FROM S_BASE_ITEM  F  WHERE  F.HOSP_ID=SUBSTR(A.HOSP_ID,1,8) AND F.ITEM_CODE=A.ITEM_CODE AND F.SOURCE_SYS = 'DEFAULT' AND ROWNUM=1 )  END,'4')  AS "PRE_LIST.MEDIC_SAFETYCLASS",-- 医保药品分类
A.UPDATE_DTIME AS "PRE_LIST.CREATE_TIME",-- 创建时间
A.UPDATE_DTIME AS "PRE_LIST.MODIFY_TIME",-- 更新时间
NULL AS "PRE_LIST.MEDIC_REMARK",-- 备注


A.ITEM_CODE AS "PRE_LIST.YPID",-- 药品采购唯一编码
NULL AS "PRE_LIST.FREQUENCY_REMARK",-- 单周期内执行时间描述，日三可描述为8-12-16，1/2日可描述为8等
(SELECT B.DRUG_CONF_NO FROM S_BASE_DRUG B  WHERE SUBSTR (A.HOSP_ID,1,8)=B.HOSP_ID AND A.ITEM_CODE=B.DRUG_CODE AND ROWNUM=1) AS "PRE_LIST.DRUG_BATCH_NO",-- 药品生产批号
NULL AS "PRE_LIST.PERFORMED_CODE",-- 发药药房代码		PERFORMED_PHARMACY_CODE
(SELECT B.PACKAGE_NUM FROM S_BASE_DRUG B  WHERE SUBSTR (A.HOSP_ID,1,8)=B.HOSP_ID AND A.ITEM_CODE=B.DRUG_CODE AND ROWNUM=1) AS "PRE_LIST.PACKAGE_QUANTITY",-- 包装数量(也支持中草药)
(SELECT B.PACKAGE_UNIT FROM S_BASE_DRUG B  WHERE SUBSTR (A.HOSP_ID,1,8)=B.HOSP_ID AND A.ITEM_CODE=B.DRUG_CODE AND ROWNUM=1) AS "PRE_LIST.PACKAGE_QUANTITY_UNIT",-- 包装数量单位(也支持中草药)
A.HERB_DOSE_QTY AS "PRE_LIST.HERBAL_DOSES",-- 草药付数
NULL AS "PRE_LIST.PREPARATION_TECHNIQUE",-- 自制剂的制备方法，如草药制备方法，颗粒，膏方，水煎等
NULL AS "PRE_LIST.TCM_RECIPE_SEQUENCE",-- 中药配方的顺序号
A.DRUG_HERB_FOOTNOTES AS "PRE_LIST.DECOCTING_METHOD",-- 草药的煎制方法，如先煎、后下、单包、冲服等
NVL((SELECT ANTIBIOTIC_LEVEL  FROM S_BASE_EMPLOYEE WHERE DOCT_CODE = A.RECIPE_DOC_CODE AND SOURCE_SYS = 'DEFAULT' AND HOSP_ID = A.HOSP_ID AND ROWNUM=1),'0') AS "PRE_LIST.DOCTOR_ANTIBIOS",-- 医生抗菌药物使用权限		PRE_LIST.DOCTOR_PRIV_OF_ANTIBIOS
NULL AS "PRE_LIST.REVIEWER",-- 审核者
NULL AS "PRE_LIST.REVIEWER_ID",-- 审核者ID
NULL AS "PRE_LIST.REVIEWER_ANTIBIOS",-- 审核者抗菌药物使用权限
A.LIST_CHARGE_ID  AS "PRE_LIST.CHARG_ID",-- 收费号
NULL AS "PRE_LIST.DDD",-- DDD
NVL( CASE WHEN  A.DRUG_FLAG = '1' THEN (SELECT B.ANTIB_FLAG FROM S_BASE_DRUG B  WHERE SUBSTR (A.HOSP_ID,1,8)=B.HOSP_ID AND A.ITEM_CODE=B.DRUG_CODE AND ROWNUM=1) ELSE '' END ,'9') AS "PRE_LIST.MEDI_ANTIBIOTIC_FLAG",-- 是否抗菌药物
DECODE(NVL(  CASE WHEN  A.DRUG_FLAG = '1' THEN (SELECT B.BASEDRUG_FLAG FROM S_BASE_DRUG B  WHERE SUBSTR (A.HOSP_ID,1,8)=B.HOSP_ID AND A.ITEM_CODE=B.DRUG_CODE AND ROWNUM=1) ELSE '' END ,'9'),'1','1','0','2','9') AS "PRE_LIST.MEDI_BASE",-- 是否基本药物




	A.LIST_IS_MEDI	AS	"LIST.IS_MEDI"	,-- 	是否药品	S3	AN..2	Y	是否代码表 NBP00.00.006	20211210新增
	A.LIST_IS_MAIN	AS	"LIST.IS_MAIN"	,-- 	是否主药	S3	AN..2	Y	是否代码表 NBP00.00.006，输液处方，溶药为主药	20211210新增
	A.LIST_ANTIBIOS_FLAG	AS	"LIST.ANTIBIOS_FLAG"	,-- 	抗菌药物标志	S3	AN..2	Y	抗生素级别代码表 NBD06.00.011	20211210新增
	A.LIST_SPIRIT_FLAG	AS	"LIST.SPIRIT_FLAG"	,-- 	精神药物标志	S3	AN..2		精神药物代码表 NBC01.01.032	20211213新增
	A.LIST_ANAESTHETIZTION	AS	"LIST.ANAESTHETIZTION"	,-- 	麻醉药物标志	S3	AN..2	Y	是否代码表 NBP00.00.006	20211210新增
	A.LIST_BASE_FLAG	AS	"LIST.BASE_FLAG"	,-- 	基本药物标志	S3	AN..2	Y	基药标志代码 NBC01.01.033	20211210新增
	A.LIST_VACCINE_FLAG	AS	"LIST.VACCINE_FLAG"	,-- 	疫苗标志	S3	AN..2	Y	是否代码表 NBP00.00.006	20211210新增
	A.LIST_INFUSION_FLAG	AS	"LIST.INFUSION_FLAG"	,-- 	输液用药标志	S3	AN..2	Y	是否代码表 NBP00.00.006	20211210新增
	A.LIST_WITHDRAWAL_FLAG	AS	"LIST.WITHDRAWAL_FLAG"	,--	退药标志	S3	AN..2	Y	是否代码表 NBP00.00.006	20211210新增
	A.LIST_DOSAGE_FORM	AS	"LIST.DOSAGE_FORM"	,-- 	药物剂型代码	S3	AN..3	Y	药物剂型代码 NBC01.01.028	20211210新增	--------------------------------------------------值域转换
	A.LIST_SPECIFICATION_UNIT	AS	"LIST.SPECIFICATION_UNIT"	,-- 	药品包装规格单位	S1	AN..30	Y	药品包装规格单位，若是药品，必填。发药包装单位，例如：瓶、盒。对于医院自定义的包装，可以提供自定义的包装单位。	20211210新增
	A.LIST_SPECIFICATION_	AS	"LIST.SPECIFICATION_"	,-- 	药品包装规格系数	S1	AN..30	Y	若是药品，必填。例如：12支/每盒中的12 ，是指每盒中有12支。这里的12是指当前包装中有12个药品规格字段中的装量单位“支”的数量。对于医院自定义的包装，请提供自定义的包装中包含的最小装量单位的数量，比如包装中包含有6支，其值就为6。	20211210新增
	A.LIST_DISPENSE_NUMBER	AS	"LIST.DISPENSE_NUMBER"	,-- 	发药数量	N	N..8,2	Y		20211210新增
	A.LIST_DISPENSE_UNIT	AS	"LIST.DISPENSE_UNIT"	,-- 	发药单位	S1	AN..6	Y		20211210新增
	A.LIST_DOSE_UNITNAME	AS	"LIST.DOSE_UNITNAME"	,-- 	剂量单位名称	S1	AN..16	Y		20211210新增
	A.LIST_DOSE_UNITID	AS	"LIST.DOSE_UNITID"	,-- 	剂量单位代码	S3	AN..16	Y	药物剂量单位代码 NBC01.01.029	20211210新增	--------------------------------------------------值域转换
A.LIST_USEUNIT_ID AS	"LIST.USEUNIT_ID"	,-- 	用量单位代码	S3	AN..6	Y	药物用量单位代码 NBC01.01.030	20211210新增	--------------------------------------------------值域转换
	A.LIST_IS_SKINTESTDRUG	AS	"LIST.IS_SKINTESTDRUG"	,-- 	是否皮试药品	S3	AN..2	Y	是否代码表 NBP00.00.006	20211210新增
	A.LIST_REVISE_FLAG	AS	"LIST.REVISE_FLAG"	,-- 	修改标志	S3	AN..2	Y	正常作废代码 NBC01.01.031	20211210新增
	A.LIST_POISON_FLAG	AS	"LIST.POISON_FLAG"	,-- 	毒性药物标志	S2	N1		是否代码表 NBP00.00.006	20220419新增
	A.LIST_POISONMADE_FLAG	AS	"LIST.POISONMADE_FLAG"	,-- 	易制毒药物标志	S2	N1		是否代码表 NBP00.00.006	20220419新增
	A.LIST_MEDI_TIMING	AS	"LIST.MEDI_TIMING"	,-- 	S1	AN..50		给药时机，如：饭前、饭后、空腹等	20220419新增
	A.LIST_DRUGUSE_TOTAL	AS	"LIST.DRUGUSE_TOTAL"	,-- 	药物使用总剂量	N	N..10,4		药物使用总剂量	20220419新增
	A.LIST_DRUG_SOURCE	AS	"LIST.DRUG_SOURCE"	,-- 	药品来源代码	S2	N1		1.医院药品 2.自备药品	20220419新增
	A.LIST_MEDI_SPEED	AS	"LIST.MEDI_SPEED"	,-- 	给药速度	S1	AN..20		给药速度，静脉输液药品滴注时间和速度的描述，如：1小时、20滴/分钟，需同时传入数字和单位，单位为小时或滴/分钟	20220419新增
	A.LIST_LIMITED_TIME	AS	"LIST.LIMITED_TIME"	,-- 	限用时间	S1	AN..20		限用时间，静脉输液药品配制后使用时间的描述，如：现配现用、立即使用、2H内使用等	20220419新增
	A.LIST_MEDI_PURPOSE	AS	"LIST.MEDI_PURPOSE"	,-- 	药嘱目的	S1	AN..50		药嘱目的，（药嘱开具的目的，科室领药、带手术室等）	20220419新增
	A.LIST_PROJECT_AMOUNT	AS	"LIST.PROJECT_AMOUNT"	,-- 	项目金额	N	N..10		项目金额，单位：分	20220419新增
	A.LIST_ANTI_TUMOR_DRUG	AS	"LIST.ANTI_TUMOR_DRUG"	,-- 	抗肿瘤药物标志	S2	N1	Y	是否代码表 NBP00.00.006	20220516新增
SUBSTR (A.HOSP_ID,1,8)||DECODE((sign(8-length(B.HOSP_ID))),0,'C00',('C'||substr(B.HOSP_ID,-2)))||A.RECIPE_NO||A.ITEM_TYPE_CODE||'00' AS LKFIELD,
A.BASE_ID AS AUTO_ID,
A.UPDATE_DTIME AS RBUSINESS_DATE
FROM S_CLI_RECIPE_CDC A
,S_CLI_SEERECORD_CDC B
WHERE  A.DRUG_FLAG='1'
AND B.OUTP_NO = A.OUTP_NO
AND B.HOSP_ID = A.HOSP_ID
AND A.RECIPE_DOC_CODE=B.CLI_DOCT_CODE
    AND A.BASE_ID=?
        ]]>
    </sql>
    <sql name="queryCLI">
        <![CDATA[
select * from S_CLI_RECIPE_KAFKA
        ]]>
    </sql>
    <sql name="insertC01">
        <![CDATA[

        ]]>
    </sql>
</sqls>
